<html dir="ltr">
  <head>
    <title>rails-flavored-ruby</title>
    <link rel="stylesheet" href="http://railstutorial.jp/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://railstutorial.jp/polytexnic.css" type="text/css" />
  </head>
  <body dir="ltr">
    <div id="book">

<h1 class="title">Ruby on Rails 3.2 チュートリアル</h1>


<h1 class="subtitle">実例を使ってRailsを学ぼう</h1>


<h2 class="author">Michael Hartl (マイケル・ハートル)</h2>




<h2 class="contents">目次</h2>


<div id="table_of_contents"><ol><li class="chapter"><a href="http://railstutorial.jp/beginning.html#top"><span class="number">第1章</span> ゼロから本番展開まで</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/beginning.html#sec-introduction"><span class="number">1.1</span>はじめに</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-comments_for_various_readers"><span class="number">1.1.1</span>読者の皆さまへ</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-1_1_2"><span class="number">1.1.2</span> Railsとスケールについて</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-conventions"><span class="number">1.1.3</span>この本における取り決め</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/beginning.html#sec-up_and_running"><span class="number">1.2</span> さっそく動作させる</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-development_tools"><span class="number">1.2.1</span>開発環境</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-1_2_1_1">IDE</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-1_2_1_2">テキストエディタとコマンドライン</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-1_2_1_3">ブラウザ</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-1_2_1_4">使用するツールについて</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-rubygems"><span class="number">1.2.2</span>Ruby、RubyGems、Rails、Git</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-rails_installer_windows">Railsインストーラ (Windows)</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-install_git">Gitのインストール</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-install_ruby">Rubyのインストール</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-install_rubygems">RubyGemsのインストール</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-install_rails">Railsのインストール</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-the_first_application"><span class="number">1.2.3</span>最初のアプリケーション</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-bundler"><span class="number">1.2.4</span> Bundler</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-rails_server"><span class="number">1.2.5</span> <tt>rails server</tt></a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-mvc"><span class="number">1.2.6</span>Model-view-controller (MVC)</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/beginning.html#sec-version_control"><span class="number">1.3</span>Gitによるバージョン管理</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-git_setup"><span class="number">1.3.1</span>インストールとセットアップ</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-1_3_1_1">初めてのシステム・セットアップ</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-1_3_1_2">初めてのリポジトリ・セットアップ</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-adding_and_committing"><span class="number">1.3.2</span>追加とコミット</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-1_3_3"><span class="number">1.3.3</span>Gitのメリット</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-github"><span class="number">1.3.4</span> GitHub</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-git_commands"><span class="number">1.3.5</span>ブランチ (branch)、変更 (edit)、 コミット (commit)、マージ (merge)</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-git_branch">ブランチ (branch)</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-git_edit">変更 (edit)</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-git_commit">コミット (commit)</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-git_merge">マージ (merge)</a></li><li class="subsubsection"><a href="http://railstutorial.jp/beginning.html#sec-git_push">プッシュ (push)</a></li></ol></li></ol></li><li class="section"><a href="http://railstutorial.jp/beginning.html#sec-deploying"><span class="number">1.4</span>展開する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-heroku_setup"><span class="number">1.4.1</span> Herokuのセットアップ</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-heroku_step_one"><span class="number">1.4.2</span> Herokuに展開する (1)</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-1_4_3"><span class="number">1.4.3</span> Herokuに展開する (2)</a></li><li class="subsection"><a href="http://railstutorial.jp/beginning.html#sec-heroku_commands"><span class="number">1.4.4</span> Heroku コマンド</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/beginning.html#sec-beginning_conclusion"><span class="number">1.5</span> 最後に</a></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/a-demo-app.html#top"><span class="number">第2章</span>デモアプリケーション</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/a-demo-app.html#sec-planning_the_application"><span class="number">2.1</span> アプリの計画</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-modeling_demo_users"><span class="number">2.1.1</span>ユーザーのモデル設計</a></li><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-modeling_demo_microposts"><span class="number">2.1.2</span>マイクロポストのモデル設計</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/a-demo-app.html#sec-demo_users_resource"><span class="number">2.2</span>Users リソース </a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-a_user_tour"><span class="number">2.2.1</span>ユーザページを探検する</a></li><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-mvc_in_action"><span class="number">2.2.2</span> MVCの挙動</a></li><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-weaknesses_of_this_users_resource"><span class="number">2.2.3</span>Users リソースの欠点</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/a-demo-app.html#sec-microposts_resource"><span class="number">2.3</span>Mircroposts リソース</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-a_micropost_microtour"><span class="number">2.3.1</span>マイクロポストのページを探検する</a></li><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-putting_the_micro_in_microposts"><span class="number">2.3.2</span>マイクロポストを<em>マイクロ</em>にする</a></li><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-demo_user_has_many_microposts"><span class="number">2.3.3</span>ユーザーとマイクロポストを<tt>has_many</tt>で関連づける</a></li><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-inheritance_hierarchies"><span class="number">2.3.4</span>継承の階層</a></li><li class="subsection"><a href="http://railstutorial.jp/a-demo-app.html#sec-deploying_the_demo_app"><span class="number">2.3.5</span>デモアプリケーションの展開</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/a-demo-app.html#sec-2_4"><span class="number">2.4</span>最後に</a></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/static-pages.html#top"><span class="number">第3章</span>ほぼ静的なページの作成</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/static-pages.html#sec-static_pages"><span class="number">3.1</span>静的ページ</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-truly_static_pages"><span class="number">3.1.1</span>「本当に」静的なページ</a></li><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-static_pages_with_rails"><span class="number">3.1.2</span>Railsによる静的なページ</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/static-pages.html#sec-first_tests"><span class="number">3.2</span>最初のテスト</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-TDD"><span class="number">3.2.1</span>テスト駆動開発</a></li><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-adding_a_page"><span class="number">3.2.2</span>ページの追加</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/static-pages.html#sec-red">赤 (Red)</a></li><li class="subsubsection"><a href="http://railstutorial.jp/static-pages.html#sec-green">緑 (Green)</a></li><li class="subsubsection"><a href="http://railstutorial.jp/static-pages.html#sec-refactor">リファクタリング</a></li></ol></li></ol></li><li class="section"><a href="http://railstutorial.jp/static-pages.html#sec-slightly_dynamic_pages"><span class="number">3.3</span>ちょっとだけ動的ページ</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-testing_a_title_change"><span class="number">3.3.1</span>タイトル変更をテストする</a></li><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-passing_title_tests"><span class="number">3.3.2</span>タイトルのテストをパスさせる</a></li><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-embedded_ruby"><span class="number">3.3.3</span>組込みRuby</a></li><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-layouts"><span class="number">3.3.4</span>レイアウトを使って重複を解消する</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/static-pages.html#sec-static_pages_conclusion"><span class="number">3.4</span>最後に</a></li><li class="section"><a href="http://railstutorial.jp/static-pages.html#sec-static_pages_exercises"><span class="number">3.5</span>演習</a></li><li class="section"><a href="http://railstutorial.jp/static-pages.html#sec-advanced_setup"><span class="number">3.6</span>高度なセットアップ</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-eliminating_bundle_exec"><span class="number">3.6.1</span><tt>bundle exec</tt>を追放する</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/static-pages.html#sec-rvm_bundler_integration">RVM Bundler の統合</a></li><li class="subsubsection"><a href="http://railstutorial.jp/static-pages.html#sec-binstubs">binstubオプション</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-guard"><span class="number">3.6.2</span>Guardによるテストの自動化</a></li><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-spork"><span class="number">3.6.3</span>Spork を使ったテストの高速化</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/static-pages.html#sec-spork_and_guard">GuardにSporkを導入する</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/static-pages.html#sec-tests_inside_sublime_text"><span class="number">3.6.4</span>Sublime Text上でテストする</a></li></ol></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/rails-flavored-ruby.html#top"><span class="number">第4章</span> Rails風味のRuby</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-motivation"><span class="number">4.1</span>動機</a></li><li class="section"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-strings_and_methods"><span class="number">4.2</span>文字列(string)とメソッド</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-comments"><span class="number">4.2.1</span>コメント</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-strings"><span class="number">4.2.2</span>文字列</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-printing">出力</a></li><li class="subsubsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-single_quoted_strings">シングルクォート内の文字列</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-objects_and_message_passing"><span class="number">4.2.3</span>オブジェクトとメッセージ受け渡し</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-method_definitions"><span class="number">4.2.4</span>メソッドの定義</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-back_to_the_title_helper"><span class="number">4.2.5</span> title ヘルパー、再び</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-other_data_structures"><span class="number">4.3</span>他のデータ構造</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-arrays_and_ranges"><span class="number">4.3.1</span>配列と範囲演算子</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-blocks"><span class="number">4.3.2</span>ブロック</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-hashes_and_symbols"><span class="number">4.3.3</span>ハッシュとシンボル</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-css_revisited"><span class="number">4.3.4</span> CSS、再び</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-ruby_classes"><span class="number">4.4</span> Ruby におけるクラス</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-constructors"><span class="number">4.4.1</span>コンストラクタ</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-a_class_of_our_own"><span class="number">4.4.2</span>クラス継承</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-modifying_built_in_classes"><span class="number">4.4.3</span>組込みクラスの変更</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-a_controller_class"><span class="number">4.4.4</span>コントローラクラス</a></li><li class="subsection"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-a_user_class"><span class="number">4.4.5</span>ユーザークラス</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-conclusion"><span class="number">4.5</span>最後に</a></li><li class="section"><a href="http://railstutorial.jp/rails-flavored-ruby.html#sec-exercises"><span class="number">4.6</span>演習</a></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/filling-in-the-layout.html#top"><span class="number">第5章</span>レイアウトを作成する</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-structure"><span class="number">5.1</span>構造を追加する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-adding_to_the_layout"><span class="number">5.1.1</span>ナビゲーション</a></li><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-custom_css"><span class="number">5.1.2</span>BootstrapとカスタムCSS</a></li><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-partials"><span class="number">5.1.3</span>パーシャル (partial)</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-sass_and_the_asset_pipeline"><span class="number">5.2</span>Sass と asset pipleline</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-the_asset_pipeline"><span class="number">5.2.1</span> asset pipeline</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-5_2_1_1">asset ディレクトリ</a></li><li class="subsubsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-5_2_1_2">マニフェストファイル</a></li><li class="subsubsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-5_2_1_3">プリプロセッサエンジン</a></li><li class="subsubsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-5_2_1_4">プロダクション環境での効率性</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-sass"><span class="number">5.2.2</span>素晴らしい構文を備えたスタイルシート</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-5_2_2_1">ネスト</a></li><li class="subsubsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-5_2_2_2">変数</a></li></ol></li></ol></li><li class="section"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-layout_links"><span class="number">5.3</span>レイアウトのリンク</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-route_tests"><span class="number">5.3.1</span> ルートのテスト</a></li><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-rails_routes"><span class="number">5.3.2</span> Railsのルート</a></li><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-named_routes"><span class="number">5.3.3</span>名前付きルート</a></li><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-pretty_rspec"><span class="number">5.3.4</span>Pretty RSpec</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-user_signup"><span class="number">5.4</span>ユーザーのサインアップ：最初のステップ</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-users_controller"><span class="number">5.4.1</span>ユーザーコントローラ</a></li><li class="subsection"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-signup_url"><span class="number">5.4.2</span>サインアップURI</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-layout_conclusion"><span class="number">5.5</span>最後に</a></li><li class="section"><a href="http://railstutorial.jp/filling-in-the-layout.html#sec-layout_exercises"><span class="number">5.6</span>演習</a></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/modeling-users.html#top"><span class="number">第6章</span>ユーザーのモデルを作成する</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/modeling-users.html#sec-user_model"><span class="number">6.1</span> Userモデル</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-database_migrations"><span class="number">6.1.1</span>データベースの移行</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-the_model_file"><span class="number">6.1.2</span>modelファイル</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/modeling-users.html#sec-model_annotation">モデル注釈</a></li><li class="subsubsection"><a href="http://railstutorial.jp/modeling-users.html#sec-accessible_attributes">アクセス可能な属性</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-creating_user_objects"><span class="number">6.1.3</span>ユーザーオブジェクトを作成する</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-finding_user_objects"><span class="number">6.1.4</span>ユーザーオブジェクトを検索する</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-updating_user_objects"><span class="number">6.1.5</span>ユーザーオブジェクトを更新する</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/modeling-users.html#sec-user_validations"><span class="number">6.2</span>ユーザーを検証する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-initial_user_tests"><span class="number">6.2.1</span>最初のユーザーテスト</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-presence_validation"><span class="number">6.2.2</span>プレゼンスを検証する</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-length_validation"><span class="number">6.2.3</span>長さを検証する</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-format_validation"><span class="number">6.2.4</span>フォーマットを検証する</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-uniqueness_validation"><span class="number">6.2.5</span>一意性を検証する</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/modeling-users.html#sec-the_caveat">一意性の警告</a></li></ol></li></ol></li><li class="section"><a href="http://railstutorial.jp/modeling-users.html#sec-adding_a_secure_password"><span class="number">6.3</span>セキュアなパスワードを追加する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-an_encrypted_password"><span class="number">6.3.1</span>暗号化されたパスワード</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-password_and_confirmation"><span class="number">6.3.2</span>パスワードと確認</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-user_authentication"><span class="number">6.3.3</span>ユーザー認証</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-has_secure_password"><span class="number">6.3.4</span>ユーザーがセキュアなパスワードを持っている</a></li><li class="subsection"><a href="http://railstutorial.jp/modeling-users.html#sec-creating_a_user"><span class="number">6.3.5</span>ユーザーを作成する</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/modeling-users.html#sec-6_4"><span class="number">6.4</span>最後に</a></li><li class="section"><a href="http://railstutorial.jp/modeling-users.html#sec-6_5"><span class="number">6.5</span>演習</a></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/sign-up.html#top"><span class="number">第7章</span>ユーザー登録</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/sign-up.html#sec-showing_users"><span class="number">7.1</span>ユーザーを表示する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-rails_environments"><span class="number">7.1.1</span>デバッグとRails環境</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-a_users_resource"><span class="number">7.1.2</span>ユーザーリソース</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-tests_with_factories"><span class="number">7.1.3</span>ファクトリーを使用してユーザー表示ページをテストする</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-a_gravatar_image"><span class="number">7.1.4</span>gravatar画像とサイドバー</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/sign-up.html#sec-signup_form"><span class="number">7.2</span>ユーザー登録フォーム</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-tests_for_user_signup"><span class="number">7.2.1</span>ユーザー登録のためのテスト</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-using_form_for"><span class="number">7.2.2</span><tt>form_for</tt>を使用する</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-the_form_html"><span class="number">7.2.3</span>フォームHTML</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/sign-up.html#sec-signup_failure"><span class="number">7.3</span>ユーザー登録失敗</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-a_working_form"><span class="number">7.3.1</span>正しいフォーム</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-signup_error_messages"><span class="number">7.3.2</span>ユーザー登録のエラーメッセージ</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/sign-up.html#sec-signup_success"><span class="number">7.4</span>ユーザー登録成功</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-the_finished_signup_form"><span class="number">7.4.1</span>登録フォームの完成</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-the_flash"><span class="number">7.4.2</span>flash</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-the_first_signup"><span class="number">7.4.3</span>実際のユーザー登録</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-up.html#sec-deploying_to_production_with_ssl"><span class="number">7.4.4</span> SSLを導入してプロダクション環境を展開する</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/sign-up.html#sec-7_5"><span class="number">7.5</span>最後に</a></li><li class="section"><a href="http://railstutorial.jp/sign-up.html#sec-signup_exercises"><span class="number">7.6</span>演習</a></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/sign-in-sign-out.html#top"><span class="number">第8章</span>サインイン、サインアウト</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-signin_failure"><span class="number">8.1</span>セッション、サインインの失敗</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-sessions_controller"><span class="number">8.1.1</span>Sessionコントローラ</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-signin_tests"><span class="number">8.1.2</span>サインインをテストする</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-signin_form"><span class="number">8.1.3</span>サインインのフォーム</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-reviewing_form_submission"><span class="number">8.1.4</span>確認フォームを送信する</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-rendering_with_a_flash_message"><span class="number">8.1.5</span>フラッシュメッセージをレンダリングする</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-signin_success"><span class="number">8.2、</span>サインイン成功</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-remember_me"><span class="number">8.2.1</span>[このアカウント設定を保存する]</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-a_working_sign_in_method"><span class="number">8.2.2</span>正しい<tt>sign_in</tt>メソッド</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-current_user"><span class="number">8.2.3</span>現在のユーザー</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-changing_the_layout_links"><span class="number">8.2.4</span>レイアウトリンクを変更する</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-signin_upon_signup"><span class="number">8.2.5</span>ユーザー登録と同時にサインインする</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-signing_out"><span class="number">8.2.6</span>サインアウトする</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-cucumber"><span class="number">8.3</span>Cucumberの紹介(オプション)</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-installation_and_setup"><span class="number">8.3.1</span>インストールと設定</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-features_and_steps"><span class="number">8.3.2</span>機能と手順</a></li><li class="subsection"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-rspec_custom_matchers"><span class="number">8.3.3</span>対比: RSpecのカスタムマッチャー</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-8_4"><span class="number">8.4</span>最後に</a></li><li class="section"><a href="http://railstutorial.jp/sign-in-sign-out.html#sec-sign_in_out_exercises"><span class="number">8.5</span>演習</a></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#top"><span class="number">第9章</span> ユーザーの更新・表示・削除</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-updating_users"><span class="number">9.1</span>ユーザーを更新する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-edit_form"><span class="number">9.1.1</span>編集フォーム</a></li><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-unsuccessful_edits"><span class="number">9.1.2</span>編集の失敗</a></li><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-successful_edits"><span class="number">9.1.3</span>編集の成功</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-authorization"><span class="number">9.2</span>認証</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-requiring_signed_in_users"><span class="number">9.2.1</span>ユーザーのサインインを要求する</a></li><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-requiring_the_right_user"><span class="number">9.2.2</span>正しいユーザーを要求する</a></li><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-friendly_forwarding"><span class="number">9.2.3</span>フレンドリーフォワーディング</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-showing_all_users"><span class="number">9.3</span>すべてのユーザーを表示する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-user_index"><span class="number">9.3.1</span>ユーザーインデックス</a></li><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-sample_users"><span class="number">9.3.2</span>サンプルのユーザー</a></li><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-pagination"><span class="number">9.3.3</span>ページネーション</a></li><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-partial_refactoring"><span class="number">9.3.4</span>部分的リファクタリング</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-destroying_users"><span class="number">9.4</span>ユーザを削除する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-administrative_users"><span class="number">9.4.1</span>管理ユーザー</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-revisiting_attr_accessible"><tt>attr_accessible</tt>属性再び</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-the_destroy_action"><span class="number">9.4.2</span> <tt>destroy</tt>アクション</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-updating_and_deleting_users_conclusion"><span class="number">9.5</span>最後に</a></li><li class="section"><a href="http://railstutorial.jp/updating-showing-and-deleting-users.html#sec-updating_deleting_exercises"><span class="number">9.6</span>演習</a></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/user-microposts.html#top"><span class="number">第10章</span>ユーザーのマイクロポスト</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/user-microposts.html#sec-a_micropost_model"><span class="number">10.1</span>マイクロポストのモデル</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-the_basic_model"><span class="number">10.1.1</span>基本的なモデル</a></li><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-accessible_attribute"><span class="number">10.1.2</span>Accessible属性と最初の検証</a></li><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-user_micropost_associations"><span class="number">10.1.3</span>User/Micropostの関連付け</a></li><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-ordering_and_dependency"><span class="number">10.1.4</span>マイクロポストを改良する</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/user-microposts.html#sec-default_scope">デフォルトのスコープ</a></li><li class="subsubsection"><a href="http://railstutorial.jp/user-microposts.html#sec-dependent_destroy">Dependent: destroy</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-micropost_validations"><span class="number">10.1.5</span>コンテンツの検証</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/user-microposts.html#sec-showing_microposts"><span class="number">10.2</span>マイクロポストを表示する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-augmenting_the_user_show_page"><span class="number">10.2.1</span>ユーザー表示ページの拡張</a></li><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-sample_microposts"><span class="number">10.2.2</span>マイクロポストのサンプル</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/user-microposts.html#sec-manipulating_microposts"><span class="number">10.3</span>マイクロポストを操作する</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-access_control"><span class="number">10.3.1</span>アクセス制御</a></li><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-creating_microposts"><span class="number">10.3.2</span>マイクロポストを作成する</a></li><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-a_proto_feed"><span class="number">10.3.3</span>フィードの原型</a></li><li class="subsection"><a href="http://railstutorial.jp/user-microposts.html#sec-destroying_microposts"><span class="number">10.3.4</span>マイクロポストを削除する</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/user-microposts.html#sec-10_4"><span class="number">10.4</span>最後に</a></li><li class="section"><a href="http://railstutorial.jp/user-microposts.html#sec-micropost_exercises"><span class="number">10.5</span>演習</a></li></ol></li><li class="chapter"><a href="http://railstutorial.jp/following-users.html#top"><span class="number">第11章</span>ユーザーをフォローする</a></li><li><ol><li class="section"><a href="http://railstutorial.jp/following-users.html#sec-the_relationship_model"><span class="number">11.1</span>Relationshipのモデル</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-a_problem_with_the_data_model"><span class="number">11.1.1</span>データモデルの問題 (および解決策)</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-relationship_user_associations"><span class="number">11.1.2</span>User/relationshipの関連付け</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-relationship_validations"><span class="number">11.1.3</span>検証</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-following"><span class="number">11.1.4</span>フォローしているユーザー</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-followers"><span class="number">11.1.5</span>フォローされているユーザー</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/following-users.html#sec-a_web_interface_for_following_and_followers"><span class="number">11.2</span>フォローしているユーザー用のWebインターフェイス</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-sample_following_data"><span class="number">11.2.1</span>フォローしているユーザーのサンプルデータ</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-stats_and_a_follow_form"><span class="number">11.2.2</span>統計とフォロー用フォーム</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-following_and_followers_pages"><span class="number">11.2.3</span>「フォローしている」と「フォローされている」のページ</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-a_working_follow_button_the_standard_way"><span class="number">11.2.4</span>[フォローする] ボタン (標準的な方法)</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-a_working_follow_button_with_ajax"><span class="number">11.2.5</span>[フォローする] ボタン (Ajax)</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/following-users.html#sec-the_status_feed"><span class="number">11.3</span>ステータスフィード</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-motivation_and_strategy"><span class="number">11.3.1</span>動機と計画</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-a_first_feed_implementation"><span class="number">11.3.2</span>フィードを初めて実装する</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-scopes_subselects_and_a_lambda"><span class="number">11.3.3</span>サブセレクト</a></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-the_new_status_feed"><span class="number">11.3.4</span>新しいステータスフィード</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/following-users.html#sec-following_conclusion"><span class="number">11.4</span>最後に</a></li><li><ol><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-extensions_to_the_sample_application"><span class="number">11.4.1</span>サンプルアプリケーションの機能を拡張する</a></li><li><ol><li class="subsubsection"><a href="http://railstutorial.jp/following-users.html#sec-replies">返信機能</a></li><li class="subsubsection"><a href="http://railstutorial.jp/following-users.html#sec-messaging">メッセージ機能</a></li><li class="subsubsection"><a href="http://railstutorial.jp/following-users.html#sec-follower_notifications">フォロワーの通知</a></li><li class="subsubsection"><a href="http://railstutorial.jp/following-users.html#sec-password_reminders">パスワードリマインダー</a></li><li class="subsubsection"><a href="http://railstutorial.jp/following-users.html#sec-signup_confirmation">ユーザー登録の確認</a></li><li class="subsubsection"><a href="http://railstutorial.jp/following-users.html#sec-rss_feed">RSSフィード</a></li><li class="subsubsection"><a href="http://railstutorial.jp/following-users.html#sec-rest_api">REST API</a></li><li class="subsubsection"><a href="http://railstutorial.jp/following-users.html#sec-search">検索機能</a></li></ol></li><li class="subsection"><a href="http://railstutorial.jp/following-users.html#sec-guide_to_further_resources"><span class="number">11.4.2</span>読み物ガイド</a></li></ol></li><li class="section"><a href="http://railstutorial.jp/following-users.html#sec-following_exercises"><span class="number">11.5</span>演習</a></li></ol></li></ol></div>


<div id="main_content"></div>


<p> <span class="preamble">
</span><span class="preamble"> <span id="foreword">
</span></span><span class="preamble"><span id="foreword"><strong>前書き</strong> </span></span><br /><span class="preamble"><span id="foreword">
</span></span><span class="preamble"><span id="foreword"> </span>
</span><span class="preamble"> </span></p>

<p>私が前にいた会社 (CD Baby) は、かなり早い段階でRuby on Railsに乗り換えたのですが、またPHPに戻ってしまいました (詳細は私の名前をGoogleで検索してみて下さい)。Michael Hartl氏が書いたこの本を強く勧められ、これはやってみなければ、と試した結果、私が再びRailsに乗り換えるに至ったのがこの<em>Ruby on Railsチュートリアル</em>です。</p>

<p>私は多数のRails本を参考にしてきましたが、真の決定版と呼べるものは本書をおいて他にありません。本書ではあらゆる手順が文字通りRails流 (“Rails way”は railway にかけている) で行われており、最初はなかなか慣れませんでしたが、この本を終えた今、ついにこれこそが自然な方式だと感じられるまでになりました。また、本書はRails本の中で唯一、多くのプロが推奨するテスト駆動開発 (TDD: Test Driven Development) 方式を全編を通して実践していて、非常に分かりやすく解説されています。極めつけは、Git、GitHub、そしてHerokuまでも実例に含めた事で、チュートリアルのコード例など実際のプロジェクトの開発プロセスまでも体験できるようになっていることです。チュートリアルのコード例は、どれもチュートリアルと見事に一体化しています。</p>

<p>本書は全体が筋道だったストーリーに貫かれており、非常に素晴らしいものです。私自身、3日間かけて章の終わりにある練習問題もやりながら<em>Railsチュートリアル</em>を一気に読破しました。最初から最後まで、途中を飛ばさずにやるのが一番効果的で有益な読み方です。ぜひやってみて下さい。</p>

<p>是非お試しください。</p>

<p>デレック・シバーズ (<a href="http://sivers.org/">Derek Sivers</a>) (<a href="http://sivers.org/">sivers.org</a>)<br />
<em>元: <a href="http://www.cdbaby.com/"><em>CD Baby</em></a> (創始者)</em> <br />
<em>現在: <a href="http://thoughts.pro/"><em>Thoughts Ltd.</em></a> (創始者) </em> <br /></p>

<p> <span class="preamble">
</span><span class="preamble"><strong>謝辞</strong> </span><br /><span class="preamble">
</span><span class="preamble"> </span></p>

<p><em>Ruby on Rails チュートリアル</em>は、私の以前の著書<em>RailsSpace</em>と、その時の共著者の<a href="http://aure.com/">Aurelius Prochazka</a>に多くを負っています。Aureには、RailsSpaceでの協力と本書への支援も含め、感謝したいと思います。また、<em>RailsSpace</em>と<em>Rails チュートリアル</em>両方の編集を担当して頂いたDebra Williams Cauley氏にも謝意を表したく思います。</p>

<p>私にインスピレーションと知識を与えてくれたRubyistの方々にも感謝したいと思います:David Heinemeier Hansson、 Yehuda Katz、 Carl Lerche、 Jeremy Kemper、 Xavier Noria、 Ryan Bates、 Geoffrey Grosenbach、 Peter Cooper、 Matt Aimonetti、 Gregg Pollack、 Wayne E. Seguin、 Amy Hoy、 Dave Chelimsky、 Pat Maddox、 Tom Preston-Werner、 Chris Wanstrath、 Chad Fowler、 Josh Susser、 Obie Fernandez、 Ian McFarland、 Steven Bristol、 Pratik Naik、 Sarah Mei、 Sarah Allen、 Wolfram Arnold、 Alex Chaffee、 Giles Bowkett、 Evan Dorn、 Long Nguyen、 James Lindenbaum、 Adam Wiggins、 Tikhon Bernstam、 Ron Evans、 Wyatt Greene、 Miles Forrest、 Pivotal Labsの方々、 Herokuの方々、 thoughtbotの方々、 そしてGitHubチーム。最後に、ここに書ききれないほど多くの読者の方々から執筆中にバグ報告や提案を頂き、本書をできる限り良いものにするのに大変役立ちました。<br /></p>

<p> <span class="preamble">
</span><span class="preamble"> <span id="author">
</span></span><span class="preamble"><span id="author"><strong>著者</strong> </span></span><br /><span class="preamble"><span id="author">
</span></span><span class="preamble"><span id="author"> </span>
</span><span class="preamble"> </span></p>

<p><a href="http://michaelhartl.com/">マイケル・ハートル (Michael Hartl)</a> は、<a href="http://ruby.railstutorial.org/"><em>Ruby on Rails</em></a>を使用したweb開発を手ほどきする教材として有名な<a href="http://rubyonrails.org/">Ruby on Rails チュートリアル</a>の著者です。(今ではすっかり古くなってしまいましたが) Railsのチュートリアル本である<em>RailsSpace</em>の著述と開発に携わったことがあり、 一時人気を博したRuby on RailsベースのソーシャルネットワーキングプラットフォームInsoshiも開発していました。2011年、マイケルはRailsコミュニティへの貢献が認められて<a href="http://rubyheroes.com/heroes">Ruby Hero Award</a>を受賞しました。<a href="http://college.harvard.edu/">ハーバード大学</a>卒業後 、<a href="http://resolver.caltech.edu/CaltechETD:etd-05222003-161626">カリフォルニア工科大学</a>で<a href="http://www.caltech.edu/">物理学博士号</a>を取得し、起業プログラム<a href="http://ycombinator.com/">Y Combinator</a>の卒業生でもあります。<br /></p>

<p> <span id="license" class="preamble">
</span><span id="license" class="preamble"><strong>著作権とライセンス</strong> </span><br /><span id="license" class="preamble">
</span><span id="license" class="preamble"> </span></p>

<p><em>Ruby on Rails チュートリアル: 実例を使ってRailsを学ぼう</em>Copyright © 2010 by Michael Hartl.<em>Ruby on Rails チュートリアル</em>内のすべてのソースコードは<a href="http://www.opensource.org/licenses/mit-license.php">MITライセンス</a>および<a href="http://people.freebsd.org/~phk/">Beerwareライセンス</a> の元で提供されています。</p>

<div class="code"><div class="highlight"><pre>(The MIT License)
Copyright (c) 2012 Michael Hartl
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &quot;Software&quot;), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</br>FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHERLIABILITY, </br>WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISINGOUT OF OR </br>IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS INTHE SOFTWARE.</pre></div>
</div>


<div class="code"><div class="highlight"><pre>/*
 * ----------------------------------------------------------------------------
 * &quot;THE BEER-WARE LICENSE&quot; (Revision 42):
 * Michael Hartl wrote this code.As long as you retain this notice you
 * can do whatever you want with this stuff. If we meet some day, and you think
 * this stuff is worth it, you can buy me a beer in return.
 * ----------------------------------------------------------------------------
 */
</pre></div>
</div>


<div id="top"></div>


<h1 class="chapter"><a id="sec-4" href="http://railstutorial.jp/rails-flavored-ruby.html#top" class="heading"><span class="number">第4章</span> Rails風味のRuby</a></h1>


<p><a class="ref" href="http://railstutorial.jp/static-pages.html#top">3章</a> での例を基に、この章では Rails のための重要な Ruby の要素について探っていきます。Ruby は大きな言語ですが、幸運なことに生産性ある Rails 開発者として必要な知識は比較的少ないです。さらに、この知識は通常の Ruby を学ぶ過程とは<em>異なる</em>ため、もしあなたの目的が動的な Web アプリを作ることならば、私はあなたに Rails を最初に学び、この先 Ruby の一部分のみを取り上げることをお勧めします。Rails の<em>エキスパート</em> になるためには、あなたは Ruby をより深く理解する必要があり、そしてこの本はあなたが開発技術の基礎を築く助けになるでしょう。<a class="ref" href="http://railstutorial.jp/beginning.html#sec-comments_for_various_readers">1.1.1</a>で示したように、<em>Rails チュートリアル</em> を終えた後には <a href="http://www.amazon.com/gp/product/1430223634"><em>Beginning Ruby</em></a>、<a href="http://www.amazon.com/gp/product/1933988657"><em>The Well-Grounded Rubyist</em></a>、<a href="http://www.amazon.com/gp/product/0672328844"><em>The Ruby Way</em></a> などの純粋な Ruby についての本を読むことをお勧めします。</p>

<p>この章ではたくさんの事について触れていますが、一度に全てを覚える必要はありません。この章の先でも度々戻って参照することになります。</p>

<div class="label" id="sec-motivation"></div>


<h2><a id="sec-4_1" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-motivation" class="heading"><span class="number">4.1</span>動機</a></h2>


<p>前章で見たように、本質的には Ruby の基礎知識がなくても、Rails アプリの骨組みを作り、それのテストを始めることができました。私たちはこれをチュートリアルによるテストコードを頼り、テストが通るまでエラーメッセージを発しながら行いました。この状況がずっと続くわけではありませんが、とりあえず本章では私たちの Ruby の限界に向き合うこととしましょう。</p>

<p>前章の終わりでは、静的ページの大部分において Rails の レイアウト を使うことで ビュー での重複を排除しました(<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-application_layout_redux">Listing 4.1</a>)。</p>

<div class="label" id="code-application_layout_redux"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.1.</span> <span class="description">サンプルアプリケーションのサイトレイアウトです。</span><br /><span class="description"> <code>app/views/layouts/application.html.erb</code></span> </div>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;!</span><span class="cp">DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Ruby on Rails Tutorial Sample App | <span class="cp">&lt;%=</span> <span class="k">yield</span><span class="p">(</span><span class="ss">:title</span><span class="p">)</span> <span class="cp">%&gt;</span><span class="nt">&lt;/title&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span>    <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">&quot;application&quot;</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">csrf_meta_tags</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/head＞</span>
  <span class="nt">&lt;body＞</span>
    <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp"></span>%&gt;{/0｝
  <span class="nt">&lt;/body＞</span>
<span class="nt">&lt;/html＞</span>
</pre></div>
</div></div>


<p><a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-application_layout_redux">リスト 4.1</a>: でのこの行に注目します。</p>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span> <span class="cp">%&gt;</span>
</pre></div>
</div>


<p>これは Rails の組み込み関数である、 <code>stylesheet_link_tag</code> (詳細については、<a href="http://api.rubyonrails.org/v3.2.0/classes/ActionView/Helpers/AssetTagHelper/StylesheetTagHelpers.html#method-i-stylesheet_link_tag">Rails API</a>を見てください) を <code>application.css</code> を全ての<a href="http://www.w3.org/TR/CSS2/media.html">メディアタイプ</a> (コンピュータの画面や印刷画面を含みます) に含めるために使っています。Rails 開発経験者にとっては、この行はとても単純に見えますが、しかし少なくとも4つの混乱させかねない Ruby のアイデアがあります: Rails の組み込み関数、括弧なしでの関数呼び出し、シンボル、そしてハッシュです。この章ではこれらアイデアの全てを説明します。</p>

<p>view の中で使える多くのビルトイン関数に加えて、Rails は新しく関数を作ることも可能にします。そのような関数は、 <em>ヘルパ</em>と呼ばれます; ヘルパを自作する方法を知るために、まずは<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-application_layout_redux">Listing 4.1</a>のタイトルについての行の調査から始めましょう。</p>

<div class="code"><div class="highlight"><pre>Ruby on Rails Tutorial Sample App | <span class="cp">&lt;%=</span> <span class="k">yield</span><span class="p">(</span><span class="ss">:title</span><span class="p">)</span> <span class="cp">%&gt;</span>
</pre></div>
</div>


<p>これはそれぞれの view におけるページタイトルの定義(<code>provide</code>を用いています)に頼っています。</p>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">provide</span><span class="p">(</span><span class="ss">:title</span><span class="p">,</span> <span class="s1">&#39;Home&#39;</span><span class="p">)</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;h1&gt;</span>Sample App<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;p&gt;</span>
  This is the home page for the
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://railstutorial.org/&quot;</span><span class="nt">&gt;</span>Ruby on Rails Tutorial<span class="nt">&lt;/a&gt;</span>
  sample application.
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>


<p>しかし、もしもタイトルを定義しなかったらどうなるでしょう?全てのページで使っている<em>基本タイトル</em>を持ち、もしも特定のページで特定のタイトルにしたい場合のためのオプションを持たせるとよさそうです。これは <em>ほとんど</em> 既に現在の layout で達成していますが、1ついい案があります: ご存知の通り、もしも <code>provide</code> による呼び出しを1つの view で消したならば、ページ固有のタイトルはなくなり下のようなタイトルとなります。</p>

<div class="code"><div class="highlight"><pre>Ruby on Rails Tutorial Sample App | 
</pre></div>
</div>


<p>つまり、適切な基本タイトルはありますが、終わりに縦棒 <code>|</code> が残っています。</p>

<p>このページタイトルがおかしくなる問題を解決するために、 <code>full_title</code> というヘルパを作りましょう。<code>full_title</code> ヘルパはもしもページタイトルが定義されていなければ基本タイトルである “Ruby on Rails Tutorial Sample App”を返し、定義されているならば基本タイトルに縦棒とページタイトルを追加して返します。 (<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-title_helper">Listing 4.2</a>).<sup class="footnote" id="fnref-4_1"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_1">1</a></sup></p>

<div class="label" id="code-title_helper"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.2.</span> <span class="description">Defining a <code>full_title</code> helper. </span><br /><span class="description"> <code>app/helpers/application_helper.rb</code></span> </div>
<div class="code"><div class="highlight"><pre><span class="k">module</span> <span class="nn">ApplicationHelper</span>

  <span class="c1"># Returns the full title on a per-page basis.</span>
  <span class="k">def</span> <span class="nf">full_title</span><span class="p">(</span><span class="n">page_title</span><span class="p">)</span>
    <span class="n">base_title</span> <span class="o">=</span> <span class="s2">&quot;Ruby on Rails Tutorial Sample App&quot;</span>
    <span class="k">if</span> <span class="n">page_title</span><span class="o">.</span><span class="n">empty?</span>
      <span class="n">base_title</span>
    <span class="k">else</span>
      <span class="s2">&quot;</span><span class="si">#{</span><span class="n">base_title</span><span class="si">}</span><span class="s2"> | </span><span class="si">#{</span><span class="n">page_title</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div></div>


<p>ヘルパを作ったので、 layout の下記の行を</p>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;title&gt;</span>Ruby on Rails Tutorial Sample App | <span class="cp">&lt;%=</span> <span class="k">yield</span><span class="p">(</span><span class="ss">:title</span><span class="p">)</span> <span class="cp">%&gt;</span><span class="nt">&lt;/title&gt;</span>
</pre></div>
</div>


<p>この行と</p>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;title&gt;</span><span class="cp">&lt;%=</span> <span class="n">full_title</span><span class="p">(</span><span class="k">yield</span><span class="p">(</span><span class="ss">:title</span><span class="p">))</span> <span class="cp">%&gt;</span><span class="nt">&lt;/title&gt;</span>
</pre></div>
</div>


<p><a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-application_layout_full_title">Listing 4.3</a> のように書き替えてください。</p>

<div class="label" id="code-application_layout_full_title"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.3.</span> <span class="description">The sample application site layout. </span><br /><span class="description"> <code>app/views/layouts/application.html.erb</code></span> </div>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;!</span><span class="cp">DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span><span class="cp">&lt;%=</span> <span class="n">full_title</span><span class="p">(</span><span class="k">yield</span><span class="p">(</span><span class="ss">:title</span><span class="p">))</span> <span class="cp">%&gt;</span><span class="nt">&lt;/title&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span>    <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s2">&quot;application&quot;</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">csrf_meta_tags</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div></div>


<p>このヘルパを定義することで、基本タイトルになるのでホームページにおける &quot;Home&quot; という不要な単語を消すことができます。最初に<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-home_base_title_spec">Listing 4.4</a>に示すように以前のテストコードを更新し、<code>&#39;Home&#39;</code>の文字がないことを確認するテストを追加しましょう。</p>

<div class="label" id="code-home_base_title_spec"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.4.</span> <span class="description">Updated tests for the Home page’s title. </span><br /><span class="description"> <code>spec/requests/static_pages_spec.rb</code></span> </div>
<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">&#39;spec_helper&#39;</span>

<span class="n">describe</span> <span class="s2">&quot;Static pages&quot;</span> <span class="k">do</span>

  <span class="n">describe</span> <span class="s2">&quot;Home page&quot;</span> <span class="k">do</span>

    <span class="n">it</span> <span class="s2">&quot;should have the h1 &#39;Sample App&#39;&quot;</span> <span class="k">do</span>
      <span class="n">visit</span> <span class="s1">&#39;/static_pages/home&#39;</span>
      <span class="n">page</span><span class="o">.</span><span class="n">should</span> <span class="n">have_selector</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">,</span> <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s1">&#39;Sample App&#39;</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="n">it</span> <span class="s2">&quot;should have the base title&quot;</span> <span class="k">do</span>
      <span class="n">visit</span> <span class="s1">&#39;/static_pages/home&#39;</span>
      <span class="n">page</span><span class="o">.</span><span class="n">should</span> <span class="n">have_selector</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span>
                        <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s2">&quot;Ruby on Rails Tutorial Sample App&quot;</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="n">it</span> <span class="s2">&quot;should not have a custom page title&quot;</span> <span class="k">do</span>
      <span class="n">visit</span> <span class="s1">&#39;/static_pages/home&#39;</span>
      <span class="n">page</span><span class="o">.</span><span class="n">should_not</span> <span class="n">have_selector</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="ss">:text</span> <span class="o">=&gt;</span> <span class="s1">&#39;| Home&#39;</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div>
</div></div>


<p>もし分かるなら、なぜ現在のテストを変更せずに新しいテストを追加したのかを考えてみてください。(<em>ヒント</em>: 答えは <a class="ref" href="http://railstutorial.jp/static-pages.html#sec-testing_a_title_change">3.3.1</a> にあります)</p>

<p>テストを実行して、テストが失敗するのを確認してください:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> bundle <span class="nb">exec </span>rspec spec/requests/static_pages_spec.rb
</pre></div>
</div>


<p>テストを通すためには、<code>provide</code> の行をホームページの view から、<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-home_page_base_title">Listing 4.5</a> のように削除する必要があります。</p>

<div class="label" id="code-home_page_base_title"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.5.</span> <span class="description">The Home page with no custom page title. </span><br /><span class="description"> <code>app/views/static_pages/home.html.erb</code></span> </div>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>Sample App<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;p&gt;</span>
  This is the home page for the
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://railstutorial.org/&quot;</span><span class="nt">&gt;</span>Ruby on Rails Tutorial<span class="nt">&lt;/a&gt;</span>
  sample application.
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div></div>


<p>これでテストが通るでしょう:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> bundle <span class="nb">exec </span>rspec spec/requests/static_pages_spec.rb
</pre></div>
</div>


<p>stylesheet を include する行のように、<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-title_helper">Listing 4.2</a> のコードはRails での開発経験者にとってはシンプルに見えますが、しかしそれは<em>たくさんの</em>混乱する可能性のある Ruby のアイデアがあります : モジュール、コメント、ローカル変数割り当て、ブーリアン、制御フロー、文字列の挿入、戻り値です。この章では、これら全てのアイデアを説明します。</p>

<div class="label" id="sec-strings_and_methods"></div>


<h2><a id="sec-4_2" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-strings_and_methods" class="heading"><span class="number">4.2</span>文字列(string)とメソッド</a></h2>


<p>Ruby を学ぶための主なツールは <em>Rails コンソール</em>という、<a class="ref" href="http://railstutorial.jp/a-demo-app.html#sec-demo_user_has_many_microposts">2.3.3</a> で登場した Rail アプリケーションを対話的に操作するためのコマンドラインツールです。コンソールは対話的 Ruby(<code>irb</code>) 上に作られており、そのため Ruby の全ての機能を使うことができます。(<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-a_controller_class">4.4.4</a>で見たように、コンソールはまた Rails 環境にもアクセスできます。) 下記のコマンドによってコンソールを起動しましょう。</p>

<div class="code"><div class="highlight"><pre><span class="go">$ rails console</span>
<span class="go">Loading development environment</span>
<span class="gp">&gt;&gt; </span>
</pre></div>
</div>


<p>デフォルトでは、コンソールは <em>development 環境</em>というRails によって定義された3種類の環境のうちの1つで起動します( 他は<em>test 環境</em>と<em>production 環境</em>です)。この区別はこの章においては重要ではありませんが、<a class="ref" href="http://railstutorial.jp/sign-up.html#sec-rails_environments">7.1.1</a>でよりこれらの環境について学ぶことになります。</p>

<p>コンソールは素晴しい学習ツールで、そして自由に探索できます—心配することはありません、あなたは(おそらく)何も壊すことはないでしょう。コンソールを使うとき、スタックから抜けるためには Ctrl-C を押し、完全にコンソールを終了するには Ctrl-D を押してください。この章の残りの至る所で、あなたはそれが<a href="http://ruby-doc.org/core-1.9.3/">Ruby API</a> についての助言を得るために便利だと気づくでしょう。それは情報が詰まっています(ひょっとすると、<em>詰まり過ぎている</em>かもしれません): 例えば、Ruby の文字列についてもっと学びたいのならば、Ruby API エントリの <code>String</code> クラスを見ればよいでしょう。</p>

<div class="label" id="sec-comments"></div>


<h3><a id="sec-4_2_1" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-comments" class="heading"><span class="number">4.2.1</span>コメント</a></h3>


<p>Ruby の<em>コメント</em> はナンバー記号<code>#</code> から始まり、(&quot;ハッシュマーク&quot;や、&quot;オクトソープ&quot;とも呼ばれます) 行の終わりまで広がります。 Ruby はコメントを無視しますが、これは人読み手のために有用です(しばしば原作者も含みます!)。コード内では、</p>

<div class="code"><div class="highlight"><pre>  <span class="c1"># Returns the full title on a per-page basis.</span>
  <span class="k">def</span> <span class="nf">full_title</span><span class="p">(</span><span class="n">page_title</span><span class="p">)</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
  <span class="k">end</span>
</pre></div>
</div>


<p>最初の行は、その後に定義している関数の目的を説明しているコメントです。</p>

<p>コンソール内では、たいていはコメントを含めませんが、しかし学習のために以下のようにコメントしてみましょう。</p>

<div class="code"><div class="highlight"><pre><span class="go">$ rails console</span>
<span class="gp">&gt;&gt; </span><span class="mi">17</span> <span class="o">+</span> <span class="mi">42</span>   <span class="c1"># Integer addition</span>
<span class="go">=&gt; 59</span>
</pre></div>
</div>


<p>もしあなたがこの章に沿ってコンソールやタイピングやコピーアンドペーストをしているのならば、コメントを省略してもかまいません; コンソールはどんなときでもコメントを無視します。</p>

<div class="label" id="sec-strings"></div>


<h3><a id="sec-4_2_2" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-strings" class="heading"><span class="number">4.2.2</span>文字列</a></h3>


<p><em>Strings</em> は、Web ページが究極的にはサーバからブラウザに文字列を送っているのと等しいため、おそらくWeb アプリケーションにおいて最も重要なデータ構造です。文字列についての調査をコンソールで始めましょう、今回は<code>rails c</code>、 <code>rails console</code>のショートカットで始めましょう:</p>

<div class="code"><div class="highlight"><pre><span class="go">$ rails c</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;&quot;</span>         <span class="c1"># An empty string</span>
<span class="go">=&gt; &quot;&quot;</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;foo&quot;</span>      <span class="c1"># A nonempty string</span>
<span class="go">=&gt; &quot;foo&quot;</span>
</pre></div>
</div>


<p>これらは<em>文字列リテラル</em>と呼ばれ (また、おもしろいことに<em>リテラル文字列</em>とも呼ばれます)、ダブルクオート<code>&quot;</code> によって作られます。このコンソールはそれぞれの行を評価した結果を表示しており、文字列リテラルの場合には文字列自身です。</p>

<p>また、<code>+</code> 演算子によって、文字列を結合することもできます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s2">&quot;foo&quot;</span> <span class="o">+</span> <span class="s2">&quot;bar&quot;</span>    <span class="c1"># String concatenation</span>
<span class="go">=&gt; &quot;foobar&quot;</span>
</pre></div>
</div>


<p>この結果は<code>&quot;foo&quot;</code> と <code>&quot;bar&quot;</code> を足すと<code>&quot;foobar&quot;</code>になったということです<sup class="footnote" id="fnref-4_2"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_2">2</a></sup></p>

<p>文字列を組み立てる他の方法は、<em>補間子</em>という特殊な構文です<code>#{}</code>:<sup class="footnote" id="fnref-4_3"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_3">3</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">first_name</span> <span class="o">=</span> <span class="s2">&quot;Michael&quot;</span>    <span class="c1"># Variable assignment</span>
<span class="go">=&gt; &quot;Michael&quot;</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">first_name</span><span class="si">}</span><span class="s2"> Hartl&quot;</span>     <span class="c1"># String interpolation</span>
<span class="go">Michael Hartl (マイケル・ハートル)</span>
</pre></div>
</div>


<p>ここでは、<code>&quot;Michael&quot;</code> という値を変数 <code>first_name</code> に<em>割り当て</em>、 それは <code>&quot;#{first_name} Hartl&quot;</code> という文字列によって式展開されます。 両方の文字列を変数に割り当てることもできます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">first_name</span> <span class="o">=</span> <span class="s2">&quot;Michael&quot;</span>
<span class="go">=&gt; &quot;Michael&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">last_name</span> <span class="o">=</span> <span class="s2">&quot;Hartl&quot;</span>
<span class="go">=&gt; &quot;Hartl&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">first_name</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">last_name</span>    <span class="c1"># Concatenation, with a space in between</span>
<span class="go">Michael Hartl (マイケル・ハートル)</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">first_name</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">last_name</span><span class="si">}</span><span class="s2">&quot;</span>    <span class="c1"># The equivalent interpolation</span>
<span class="go">Michael Hartl (マイケル・ハートル)</span>
</pre></div>
</div>


<p>ここで留意するべきは、最後の2つの表記は等しいですが、私は式展開する方を好みます; 1つの空白の<code>&quot; &quot;</code>を加えることは少しぎこちなく見えます。</p>

<div class="label" id="sec-printing"></div>


<h4><a id="sec-4_2_2_1" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-printing" class="heading">出力</a></h4>


<p>文字列を<em>出力</em>するために、Ruby の関数で最も一般に使われるのは<code>puts</code>です。(“put string”なので、“put ess” と発音します):</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="s2">&quot;foo&quot;</span>     <span class="c1"># put string</span>
<span class="go">foo</span>
<span class="go">=&gt; nil</span>
</pre></div>
</div>


<p><code>puts</code> メソッドは<em>副作用</em>として働きます:<code>puts &quot;foo&quot;</code> は文字列をスクリーンに表示し、<a href="http://www.answers.com/nil">無のリテラル</a>を返します: <code>nil</code> は &quot;全く無い&quot;ことを示す Ruby の特別な値です。(今後、時々 <code>=&gt; nil</code> という表記を簡素化のために省略します。)</p>

<p><code>puts</code> を使うことで、自動的に改行文字である<tt class="verb">\n</tt> が出力に追加されます; 関連した<code>print</code> メソッドは追加しません:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;foo&quot;</span>    <span class="c1"># print string (same as puts, but without the newline)</span>
<span class="go">foo=&gt; nil</span>
<span class="gp">&gt;&gt; </span><span class="nb">print</span> <span class="s2">&quot;foo</span><span class="se">\n</span><span class="s2">&quot;</span>  <span class="c1"># Same as puts &quot;foo&quot;</span>
<span class="go">foo</span>
<span class="go">=&gt; nil</span>
</pre></div>
</div>




<div class="label" id="sec-single_quoted_strings"></div>


<h4><a id="sec-4_2_2_2" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-single_quoted_strings" class="heading">シングルクォート内の文字列</a></h4>


<p>これまでの全ての例は <em>ダブルクオート文字列</em>でしたが、Rubyは<em>シングルクオート</em>もサポートしています。多くの使い方では、これら2種類の文字列は実質的に同じです:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s1">&#39;foo&#39;</span>          <span class="c1"># A single-quoted string</span>
<span class="go">=&gt; &quot;foo&quot;</span>
<span class="gp">&gt;&gt; </span><span class="s1">&#39;foo&#39;</span> <span class="o">+</span> <span class="s1">&#39;bar&#39;</span>
<span class="go">=&gt; &quot;foobar&quot;</span>
</pre></div>
</div>


<p>けれども、重要な違いがあります; Ruby はシングルクオート文字列の中では式展開ができません:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s1">&#39;#{foo} bar&#39;</span>     <span class="c1"># Single-quoted strings don&#39;t allow interpolation</span>
<span class="go">=&gt; &quot;\#{foo} bar&quot;</span>
</pre></div>
</div>


<p>ダブルクオート文字列を用いた文字列について留意するべき点は、<code>#</code>のような特別な文字をバックスラッシュで<em>エスケープ</em>する必要があります。</p>

<p>もしもダブルクオート文字列がシングルクオート文字列のできる全てができ、式展開もできるのなら、シングルクオート文字列の長所はなんでしょう?これは真にリテラルであり、打ったままを保持できるため便利です。例えば、“バックスラッシュ” 文字は改行文字<tt class="verb">\n</tt>のように多くのシステム上で特別な文字です。 もしもバックスラッシュを含めた変数が欲しいならば、シングルクオートならば簡単にできます。</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s1">&#39;\n&#39;</span>       <span class="c1"># A literal &#39;backslash n&#39; combination</span>
<span class="go">=&gt; &quot;\\n&quot;</span>
</pre></div>
</div>


<p>前の例での<code>#</code>文字と同様に、Ruby はバックスラッシュのエスケープのためにもう1つのバックスラッシュを必要とします; ダブルクオート文字列の中では、バックスラッシュは<em>2つ</em>のバックスラッシュによって表されます。このように小さい例であれば、たいしたことはありませんが、しかしもしもエスケープする必要なものが多くあるときにはそれは本当に役に立ちます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s1">&#39;Newlines (\n) and tabs (\t) both use the backslash character \.&#39;</span>
<span class="go">=&gt; &quot;Newlines (\\n) and tabs (\\t) both use the backslash character \\.&quot;</span>
</pre></div>
</div>




<div class="label" id="sec-objects_and_message_passing"></div>


<h3><a id="sec-4_2_3" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-objects_and_message_passing" class="heading"><span class="number">4.2.3</span>オブジェクトとメッセージ受け渡し</a></h3>


<p>Ruby での、文字列や<code>nil</code>すら含む全ての物は<em>オブジェクト</em>です。 この技術的な意味は<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-a_class_of_our_own">4.4.2</a>で知ることになりますが、しかしオブジェクトについてこの本での定義を読んでも誰も分からないと思います;あなたはオブジェクトについての直感を多くの例を見ることで育てなければなりません。</p>

<p>オブジェクトが何を<em>する</em>かを説明するのは簡単です、それはメッセージに応答します。文字列のようなオブジェクトは、例えば <code>length</code>というメッセージに応答できますが、これは文字列の文字数を返します:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s2">&quot;foobar&quot;</span><span class="o">.</span><span class="n">length</span>        <span class="c1"># Passing the &quot;length&quot; message to a string</span>
<span class="go">=&gt; 6</span>
</pre></div>
</div>


<p>一般に、オブジェクトに渡されるメッセージは<em>メソッド</em>という、これらオブジェクトに定義された関数です。<sup class="footnote" id="fnref-4_4"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_4">4</a></sup> 文字列はまた<code>empty?</code>メソッドにも応答します: </p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s2">&quot;foobar&quot;</span><span class="o">.</span><span class="n">empty?</span>
<span class="go">=&gt; false</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">empty?</span>
<span class="go">=&gt; true</span>
</pre></div>
</div>


<p><code>empty?</code>メソッドの終わりにあるクエスチョンマークについて気をつけてください。 これは Rubyにおいて<code>true</code> もしくは <code>false</code>という<em>ブーリアン</em>を返すことを示す慣習です。ブーリアンは特に<em>制御フロー</em>において便利です:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;foobar&quot;</span>
<span class="gp">&gt;&gt; </span><span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">empty?</span>
<span class="gp">&gt;&gt; </span>  <span class="s2">&quot;The string is empty&quot;</span>
<span class="gp">&gt;&gt; </span><span class="k">else</span>
<span class="gp">&gt;&gt; </span>  <span class="s2">&quot;The string is nonempty&quot;</span>
end
<span class="go">=&gt; &quot;The string is nonempty&quot;</span>
</pre></div>
</div>


<p>ブーリアンはまた <code>&amp;&amp;</code> (“and”)、<code>||</code> (“or”)、そして<code>!</code> (&quot;not&quot;) 演算子によって結合されます: </p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;foo&quot;</span>
<span class="go">=&gt; &quot;foo&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="go">=&gt; &quot;&quot;</span>
<span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="s2">&quot;Both strings are empty&quot;</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">empty?</span> <span class="o">&amp;&amp;</span> <span class="n">y</span><span class="o">.</span><span class="n">empty?</span>
<span class="go">=&gt; nil</span>
<span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="s2">&quot;One of the strings is empty&quot;</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">empty?</span> <span class="o">||</span> <span class="n">y</span><span class="o">.</span><span class="n">empty?</span>
<span class="go">&quot;One of the strings is empty&quot;</span>
<span class="go">=&gt; nil</span>
<span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="s2">&quot;x is not empty&quot;</span> <span class="k">if</span> <span class="o">!</span><span class="n">x</span><span class="o">.</span><span class="n">empty?</span>
<span class="go">&quot;x is not empty&quot;</span>
<span class="go">=&gt; nil</span>
</pre></div>
</div>


<p>Ruby での全ての物はオブジェクトなので、それに従い<code>nil</code>もオブジェクトであり、それゆえ多くのメソッドに応答できます。1つの例は 実際ほとんどのオブジェクトを文字列に変換する<code>to_s</code> メソッドです:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="kp">nil</span><span class="o">.</span><span class="n">to_s</span>
<span class="go">=&gt; &quot;&quot;</span>
</pre></div>
</div>


<p>確かに空文字列が現れましたが、<code>nil</code> に対してメッセージを<em>連鎖</em>して渡せることを確認します:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="kp">nil</span><span class="o">.</span><span class="n">empty?</span>
<span class="go">NoMethodError: You have a nil object when you didn&#39;t expect it!</span>
<span class="go">You might have expected an instance of Array.</span>
<span class="go">The error occurred while evaluating nil.empty?</span>
<span class="gp">&gt;&gt; </span><span class="kp">nil</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">empty?</span>      <span class="c1"># Message chaining</span>
<span class="go">=&gt; true</span>
</pre></div>
</div>


<p>このように、<code>nil</code> オブジェクトは<code>empty?</code> メソッドに応答しないですが、 <code>nil.to_s</code>にはすることがわかりました。</p>

<p>推測できるかもしれませんが、<code>nil</code>かどうかを調べるメソッドもあります:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s2">&quot;foo&quot;</span><span class="o">.</span><span class="n">nil?</span>
<span class="go">=&gt; false</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">nil?</span>
<span class="go">=&gt; false</span>
<span class="gp">&gt;&gt; </span><span class="kp">nil</span><span class="o">.</span><span class="n">nil?</span>
<span class="go">=&gt; true</span>
</pre></div>
</div>


<p>このコードは</p>

<div class="code"><div class="highlight"><pre><span class="nb">puts</span> <span class="s2">&quot;x is not empty&quot;</span> <span class="k">if</span> <span class="o">!</span><span class="n">x</span><span class="o">.</span><span class="n">empty?</span>
</pre></div>
</div>


<p><code>if</code>キーワードの別の使い方を示しています : Ruby は <code>if</code> での条件式が真のときにだけ実行される式を書くことができます。補足としては <code>unless</code> キーワードも同様に働きます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;foobar&quot;</span>
<span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="s2">&quot;The string &#39;</span><span class="si">#{</span><span class="n">string</span><span class="si">}</span><span class="s2">&#39; is nonempty.&quot;</span> <span class="k">unless</span> <span class="n">string</span><span class="o">.</span><span class="n">empty?</span>
<span class="go">The string &#39;foobar&#39; is nonempty.</span>
<span class="go">=&gt; nil</span>
</pre></div>
</div>


<p><code>nil</code> オブジェクトは 特別で、Ruby のオブジェクトでは 条件式において<code>false</code>はさておき<em>唯一</em>偽です:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="k">if</span> <span class="kp">nil</span>
<span class="gp">&gt;&gt; </span>  <span class="kp">true</span>
<span class="gp">&gt;&gt; </span><span class="k">else</span>
<span class="gp">&gt;&gt; </span>  <span class="kp">false</span>        <span class="c1"># nil is false</span>
end
<span class="go">=&gt; false</span>
</pre></div>
</div>


<p>具体的に言うと、Ruby のオブジェクトは全て、 0 でさえ<em>true</em>です:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="k">if</span> <span class="mi">0</span>
<span class="gp">&gt;&gt; </span>  <span class="kp">true</span>        <span class="c1"># 0 (and everything other than nil and false itself) is true</span>
<span class="gp">&gt;&gt; </span><span class="k">else</span>
<span class="gp">&gt;&gt; </span>  <span class="kp">false</span>
end
<span class="go">=&gt; true</span>
</pre></div>
</div>


<div class="label" id="sec-method_definitions"></div>


<h3><a id="sec-4_2_4" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-method_definitions" class="heading"><span class="number">4.2.4</span>メソッドの定義</a></h3>


<p>コンソールでは<a class="ref" href="http://railstutorial.jp/static-pages.html#code-static_pages_controller">3.6章</a>の<code>home</code>アクションや<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-title_helper">4.2章</a>の<code>full_title</code>ヘルパと同じ方法でメソッドを定義することができます。(コンソールでのメソッドの定義は少しやっかいで、普通はファイルを使いますが、デモンストーレション目的ならばそれは便利です。)例えば、<code>string_message</code>という1つの<em>引数</em>を取り、引数が空かどうかに基づいたメッセージを返す関数を定義してみましょう:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="k">def</span> <span class="nf">string_message</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="gp">&gt;&gt; </span>  <span class="k">if</span> <span class="n">string</span><span class="o">.</span><span class="n">empty?</span>
<span class="gp">&gt;&gt; </span>    <span class="s2">&quot;It&#39;s an empty string!&quot;</span>
<span class="gp">&gt;&gt; </span>  <span class="k">else</span>
<span class="gp">&gt;&gt; </span>    <span class="s2">&quot;The string is nonempty.&quot;</span>
end
end
<span class="go">=&gt; nil</span>
<span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="n">string_message</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="go">It&#39;s an empty string!</span>
<span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="n">string_message</span><span class="p">(</span><span class="s2">&quot;foobar&quot;</span><span class="p">)</span>
<span class="go">The string is nonempty.</span>
</pre></div>
</div>


<p>ここで留意するべきは、 Ruby の関数は <em>暗黙的戻り値</em>を持つということで、これは最後の式の評価値が返ることを意味します—この場合、引数の<code>string</code>が空か否かに基づいた2つのメッセージ文字列のうちの1つです。Ruby はまた戻り値を明示することもできます; 下記の関数は上記のものと同じです:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="k">def</span> <span class="nf">string_message</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="gp">&gt;&gt; </span>  <span class="k">return</span> <span class="s2">&quot;It&#39;s an empty string!&quot;</span> <span class="k">if</span> <span class="n">string</span><span class="o">.</span><span class="n">empty?</span>
<span class="gp">&gt;&gt; </span>  <span class="k">return</span> <span class="s2">&quot;The string is nonempty.&quot;</span>
end
</pre></div>
</div>


<p>気づいているかもしれませんが、ここで注意するべき点は2つ目の <code>return</code> は実のところ不要であるということです—関数中の最後の表現である、 <code>&quot;The string is nonempty.&quot;</code>は<code>return</code>キーワードに関係なく値を返しますが、<code>return</code> が両方にあることで対称になっていて好ましいです。</p>

<div class="label" id="sec-back_to_the_title_helper"></div>


<h3><a id="sec-4_2_5" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-back_to_the_title_helper" class="heading"><span class="number">4.2.5</span> title ヘルパー、再び</a></h3>


<p>今ならば<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-title_helper">4.2</a>の<code>full_title</code> ヘルパを理解できるでしょう:<sup class="footnote" id="fnref-4_5"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_5">5</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="k">module</span> <span class="nn">ApplicationHelper</span>

  <span class="c1"># Returns the full title on a per-page basis.       </span><span class="c1"># Documentation comment</span>
  <span class="k">def</span> <span class="nf">full_title</span><span class="p">(</span><span class="n">page_title</span><span class="p">)</span>                          <span class="c1"># Method definition</span>
    <span class="n">base_title</span> <span class="o">=</span> <span class="s2">&quot;Ruby on Rails Tutorial Sample App&quot;</span>  <span class="c1"># Variable assignment</span>
    <span class="k">if</span> <span class="n">page_title</span><span class="o">.</span><span class="n">empty?</span>                              <span class="c1"># Boolean test</span>
      <span class="n">base_title</span>                                      <span class="c1"># Implicit return</span>
    <span class="k">else</span>
      <span class="s2">&quot;</span><span class="si">#{</span><span class="n">base_title</span><span class="si">}</span><span class="s2"> | </span><span class="si">#{</span><span class="n">page_title</span><span class="si">}</span><span class="s2">&quot;</span>                 <span class="c1"># String interpolation</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>


<p>これら要素—関数定義、変数割り当て、論理評価、制御フロー、そして文字列の式展開—が一体となることで、サイトレイアウトで用いられているコンパクトなヘルパメソッドが作られています。最後の要素は <code>module ApplicationHelper</code>です: モジュールは関連したメソッドをまとめる方法の1つで、Ruby のクラスに<code>include</code> を使うことで <em>ミックスイン</em>することができます。通常の Ruby を書くときには、たびたびモジュールを書いて明示的に含めますが、しかしこのヘルパモジュールの場合には Rails が含める処理をしてくれます。結果として、<code>full_title</code> メソッドは<a href="http://catb.org/jargon/html/A/automagically.html">自動的に</a> 全てのビューで利用できます。</p>

<div class="label" id="sec-other_data_structures"></div>


<h2><a id="sec-4_3" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-other_data_structures" class="heading"><span class="number">4.3</span>他のデータ構造</a></h2>


<p>結局 Web アプリは文字列ですが、実のところこれら文字列を<em>作る</em>ために他のデータ構造を使ったほうがよいです。この章では、Rail アプリケーションを書くために重要ないくつかの Ruby のデータ構造について学びます。</p>

<div class="label" id="sec-arrays_and_ranges"></div>


<h3><a id="sec-4_3_1" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-arrays_and_ranges" class="heading"><span class="number">4.3.1</span>配列と範囲演算子</a></h3>


<p>配列は特定の順番での要素のリストです。<em>Rails Tutorial</em> ではまだ話していませんが、しかしこれを理解することはハッシュ(<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-hashes_and_symbols">4.3.3</a>)を理解やRails のデータモデル(<a class="ref" href="http://railstutorial.jp/a-demo-app.html#sec-demo_user_has_many_microposts">2.3.3</a>で登場し、や <a class="ref" href="http://railstutorial.jp/user-microposts.html#sec-user_micropost_associations">10.1.3</a>でより広く学ぶ<code>has_many</code> 関係のようなことです)を学ぶためのよい基盤となります。</p>

<p>文字列を理解するための長い時間から離れて、文字列から配列を得る自然な方法の1つに<code>split</code>メソッドがあります:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span> <span class="s2">&quot;foo bar     baz&quot;</span><span class="o">.</span><span class="n">split</span>     <span class="c1"># Split a string into a three-element array</span>
<span class="go">=&gt; [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]</span>
</pre></div>
</div>


<p>この操作の結果は3つの文字列の配列です。デフォルトでは、<code>split</code> は文字列を空白で区切って配列にしますが、同様に他の文字でも区切ることができます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s2">&quot;fooxbarxbazx&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">=&gt; [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]</span>
</pre></div>
</div>


<p>ほとんどのコンピュータ言語の慣習として、 Ruby の配列は<em>ゼロオフセット</em>で、これは配列の最初の要素のインデックスは0で、2番目は1で...ということを意味します:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="o">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">17</span><span class="o">]</span>
<span class="go">=&gt; [42, 8, 17]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>               <span class="c1"># Ruby uses square brackets for array access.</span>
<span class="go">=&gt; 42</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
<span class="go">=&gt; 8</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span>
<span class="go">=&gt; 17</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span>              <span class="c1"># Indices can even be negative!</span>
<span class="go">=&gt; 17</span>
</pre></div>
</div>


<p>Ruby が配列の要素にアクセスするのに、角括弧 を用いることを示しています。この括弧により表記に加えて、 Ruby はいくつかのよくアクセスする要素のための表記法を提供しています:<sup class="footnote" id="fnref-4_6"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_6">6</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">a</span>                  <span class="c1"># Just a reminder of what &#39;a&#39; is</span>
<span class="go">=&gt; [42, 8, 17]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">first</span>
<span class="go">=&gt; 42</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">second</span>
<span class="go">=&gt; 8</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">last</span>
<span class="go">=&gt; 17</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">last</span> <span class="o">==</span> <span class="n">a</span><span class="o">[-</span><span class="mi">1</span><span class="o">]</span>    <span class="c1"># Comparison using ==</span>
<span class="go">=&gt; true</span>
</pre></div>
</div>


<p>最後の行は等しいことを比較する演算子<code>==</code>を紹介しており、これは、<code>!=</code> (“等しくない”)などと同じように Ruby は他の多くの言語と同様に使っています:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">length</span>       <span class="c1"># Like strings, arrays respond to the &#39;length&#39; method.</span>
<span class="go">=&gt; 3</span>
<span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">=&gt; true</span>
<span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">=&gt; false</span>
<span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">!</span><span class="o">=</span> <span class="mi">1</span>
<span class="go">=&gt; true</span>
<span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">1</span>
<span class="go">=&gt; true</span>
<span class="gp">&gt;&gt; </span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">1</span>
<span class="go">=&gt; false</span>
</pre></div>
</div>


<p><code>length</code> (上記コードの最初の行にあります) に加えて、配列は他の豊富なメソッドに応答します:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">a</span>
<span class="go">=&gt; [42, 8, 17]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">sort</span>
<span class="go">=&gt; [8, 17, 42]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">reverse</span>
<span class="go">=&gt; [17, 8, 42]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">shuffle</span>
<span class="go">=&gt; [17, 42, 8]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span>
<span class="go">=&gt; [42, 8, 17]</span>
</pre></div>
</div>


<p>ここで留意するべきは、上のどのメソッドも<code>a</code> 自身を変更しないという点です。配列を<em>変更する</em>ために、類似する “bang” メソッドを使います(いわゆる感嘆符が一般に “bang” と呼ばれるためです):</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">a</span>
<span class="go">=&gt; [42, 8, 17]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">sort!</span>
<span class="go">=&gt; [8, 17, 42]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span>
<span class="go">=&gt; [8, 17, 42]</span>
</pre></div>
</div>


<p>また、<code>push</code> メソッドやそれと同じ演算子である<tt class="verb">&lt;&lt;</tt>によって配列に追加できます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>                  <span class="c1"># Pushing 6 onto an array</span>
<span class="go">=&gt; [42, 8, 17, 6]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span>                     <span class="c1"># Pushing 7 onto an array</span>
<span class="go">=&gt; [42, 8, 17, 6, 7]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;foo&quot;</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;bar&quot;</span>        <span class="c1"># Chaining array pushes</span>
<span class="go">=&gt; [42, 8, 17, 6, 7, &quot;foo&quot;, &quot;bar&quot;]</span>
</pre></div>
</div>


<p>最後の例は要素の追加を繋げることができることを示しており、また、他の多くの言語での配列とは違って、Ruby の配列は様々な型を混ぜることができます( この場合では、整数と文字列です )。</p>

<p>文字列を配列に変換するのに、先程は <code>split</code> を使いました。<code>join</code> メソッドによって、その逆をすることができます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">a</span>
<span class="go">=&gt; [42, 8, 17, 7, &quot;foo&quot;, &quot;bar&quot;]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">join</span>                       <span class="c1"># Join on nothing</span>
<span class="go">=&gt; &quot;428177foobar&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>                 <span class="c1"># Join on comma-space</span>
<span class="go">=&gt; &quot;42, 8, 17, 7, foo, bar&quot;</span>
</pre></div>
</div>


<p><em>範囲</em>は、配列と密接に関係しており、<code>to_a</code>メソッドによって配列に変換すると分かりやすいかもしれません:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">9</span>
<span class="go">=&gt; 0..9</span>
<span class="gp">&gt;&gt; </span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">9</span><span class="o">.</span><span class="n">to_a</span>              <span class="c1"># Oops, call to_a on 9</span>
<span class="go">NoMethodError: undefined method `to_a&#39; for 9:Fixnum</span>
<span class="gp">&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span>            <span class="c1"># Use parentheses to call to_a on the range</span>
<span class="go">=&gt; [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</pre></div>
</div>


<p><code>0..9</code> は有効な範囲ですが、上の2つ目の表記はメソッドを呼ぶのに括弧を追加する必要があることを示しています。</p>

<p>範囲は配列の要素から値を得るのに便利です:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="sx">%w[foo bar baz quux]</span>         <span class="c1"># Use %w to make a string array.</span>
<span class="go">=&gt; [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;, &quot;quux&quot;]</span>
<span class="gp">&gt;&gt; </span><span class="n">a</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">2</span><span class="o">]</span>
<span class="go">=&gt; [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]</span>
</pre></div>
</div>


<p>範囲はまた文字に対しても動作します:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">.</span><span class="n">.</span><span class="s1">&#39;e&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span>
<span class="go">=&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]</span>
</pre></div>
</div>


<div class="label" id="sec-blocks"></div>


<h3><a id="sec-4_3_2" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-blocks" class="heading"><span class="number">4.3.2</span>ブロック</a></h3>


<p>配列と範囲は両方とも<em>ブロック</em>という Ruby の最もパワフルな一方で最も混乱する機能の1つを受けつける多くのメソッドに応答します:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="nb">puts</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="p">}</span>
<span class="go">2</span>
<span class="go">4</span>
<span class="go">6</span>
<span class="go">8</span>
<span class="go">10</span>
<span class="go">=&gt; 1..5</span>
</pre></div>
</div>


<p>このコードは 範囲オブジェクトの<code>(1..5)</code>に対して <code>each</code> メソッド呼び出し、 そしてそれに<code>{ |i| puts 2 * i }</code>というブロックを渡します。 <code>|i|</code> での変数名を囲った縦棒はブロック変数のための Ruby の構文で、メソッド次第でブロックが何をするべきか知っています。この場合、範囲オブジェクトの<code>each</code>メソッドは1つのローカル変数、ここでは<code>i</code>と呼びますが、それを持つブロックを受けつけ、そして範囲内でのそれぞれの値についてブロックを実行します。</p>

<p>波括弧はブロックを示す1つの方法ですが、 同様に2つ目の方法もあります:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
<span class="gp">?</span><span class="gp">&gt; </span>  <span class="nb">puts</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span>
end
<span class="go">2</span>
<span class="go">4</span>
<span class="go">6</span>
<span class="go">8</span>
<span class="go">10</span>
<span class="go">=&gt; 1..5</span>
</pre></div>
</div>


<p>ブロックは1行より多く書けますし、多くの場合1行以上です。<em>Rails チュートリアル</em>では、波括弧を短い1行のブロックに、<code>do..end</code> 記法を長い1行や複数行のブロックに用いるという共通の慣習に従います:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">number</span><span class="o">|</span>
<span class="gp">?</span><span class="gp">&gt; </span>  <span class="nb">puts</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">number</span>
<span class="gp">&gt;&gt; </span>  <span class="nb">puts</span> <span class="s1">&#39;--&#39;</span>
end
<span class="go">2</span>
<span class="go">--</span>
<span class="go">4</span>
<span class="go">--</span>
<span class="go">6</span>
<span class="go">--</span>
<span class="go">8</span>
<span class="go">--</span>
<span class="go">10</span>
<span class="go">--</span>
<span class="go">=&gt; 1..5</span>
</pre></div>
</div>


<p>ここでは <code>number</code> を<code>i</code> の変わりに用いることで他の変数名が使えることを強調しています。</p>

<p>十分なプログラミングの経験がない限り、ブロックを理解する簡単な方法はありません; これらをたくさん見なければなりません、そして、やがて慣れることでしょう。<sup class="footnote" id="fnref-4_7"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_7">7</a></sup> 幸運なことに、人間は具体的な例から一般化することが全く上手です; ここにもう少し、1対の<code>map</code> メソッドの利用法を含んだ例があります:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="mi">3</span><span class="o">.</span><span class="n">times</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s2">&quot;Betelgeuse!&quot;</span> <span class="p">}</span>   <span class="c1"># 3.times takes a block with no variables.</span>
<span class="go">&quot;Betelgeuse!&quot;</span>
<span class="go">&quot;Betelgeuse!&quot;</span>
<span class="go">&quot;Betelgeuse!&quot;</span>
<span class="go">=&gt; 3</span>
<span class="gp">&gt;&gt; </span><span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="p">}</span>          <span class="c1"># The ** notation is for &#39;power&#39;.</span>
<span class="go">=&gt; [1, 4, 9, 16, 25]</span>
<span class="gp">&gt;&gt; </span><span class="sx">%w[a b c]</span>                        <span class="c1"># Recall that %w makes string arrays.</span>
<span class="go">=&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span>
<span class="gp">&gt;&gt; </span><span class="sx">%w[a b c]</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">char</span><span class="o">|</span> <span class="n">char</span><span class="o">.</span><span class="n">upcase</span> <span class="p">}</span>
<span class="go">=&gt; [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;]</span>
<span class="gp">&gt;&gt; </span><span class="sx">%w[A B C]</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">char</span><span class="o">|</span> <span class="n">char</span><span class="o">.</span><span class="n">downcase</span> <span class="p">}</span>
<span class="go">=&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]</span>
</pre></div>
</div>


<p>ご覧のように、<code>map</code> メソッドは配列や範囲オブジェクトの各々の要素に与えられたブロックを適用した結果が返ります。</p>

<p>ところで、私たちは今<a class="ref" href="http://railstutorial.jp/beginning.html#sec-heroku_commands">1.4.4</a>でランダムなサブドメインを生成するために私が投げ込んだ Ruby の行について理解することができます:</p>

<div class="code"><div class="highlight"><pre><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">.</span><span class="n">.</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">shuffle</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">7</span><span class="o">].</span><span class="n">join</span>
</pre></div>
</div>


<p>段階的に組み立ててみましょう:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">.</span><span class="n">.</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span>                     <span class="c1"># An alphabet array</span>
<span class="go">=&gt; [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;, &quot;k&quot;, &quot;l&quot;, &quot;m&quot;, &quot;n&quot;, &quot;o&quot;,</span>
<span class="go">&quot;p&quot;, &quot;q&quot;, &quot;r&quot;, &quot;s&quot;, &quot;t&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;]</span>
<span class="gp">&gt;&gt; </span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">.</span><span class="n">.</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">shuffle</span>             <span class="c1"># Shuffle it.</span>
<span class="go">=&gt; [&quot;c&quot;, &quot;g&quot;, &quot;l&quot;, &quot;k&quot;, &quot;h&quot;, &quot;z&quot;, &quot;s&quot;, &quot;i&quot;, &quot;n&quot;, &quot;d&quot;, &quot;y&quot;, &quot;u&quot;, &quot;t&quot;, &quot;j&quot;, &quot;q&quot;,</span>
<span class="go">&quot;b&quot;, &quot;r&quot;, &quot;o&quot;, &quot;f&quot;, &quot;e&quot;, &quot;w&quot;, &quot;v&quot;, &quot;m&quot;, &quot;a&quot;, &quot;x&quot;, &quot;p&quot;]</span>
<span class="gp">&gt;&gt; </span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">.</span><span class="n">.</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">shuffle</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">7</span><span class="o">]</span>       <span class="c1"># Pull out the first eight elements.</span>
<span class="go">=&gt; [&quot;f&quot;, &quot;w&quot;, &quot;i&quot;, &quot;a&quot;, &quot;h&quot;, &quot;p&quot;, &quot;c&quot;, &quot;x&quot;]</span>
<span class="gp">&gt;&gt; </span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">.</span><span class="n">.</span><span class="s1">&#39;z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">shuffle</span><span class="o">[</span><span class="mi">0</span><span class="o">.</span><span class="n">.</span><span class="mi">7</span><span class="o">].</span><span class="n">join</span>  <span class="c1"># Join them together to make one string.</span>
<span class="go">=&gt; &quot;mznpybuj&quot;</span>
</pre></div>
</div>




<div class="label" id="sec-hashes_and_symbols"></div>


<h3><a id="sec-4_3_3" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-hashes_and_symbols" class="heading"><span class="number">4.3.3</span>ハッシュとシンボル</a></h3>


<p>ハッシュは本質的には汎化された配列です: ハッシュを基本的に配列のように考えることができますが、整数のインデックスに限りません。(実のところ、いくつかの言語では、特に Perl では、たまにハッシュを この理由によって<em>連想配列</em> と呼びます。) その代わりに、ハッシュのインデックス、もしくは<em>キー</em>、はたいてい何らかのオブジェクトです。例えば、文字列をキーとして使うことができます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="p">{}</span>                          <span class="c1"># {} is an empty hash.</span>
<span class="go">=&gt; {}</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">[</span><span class="s2">&quot;first_name&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Michael&quot;</span>     <span class="c1"># Key &quot;first_name&quot;, value &quot;Michael&quot;</span>
<span class="go">=&gt; &quot;Michael&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">[</span><span class="s2">&quot;last_name&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&quot;Hartl&quot;</span>        <span class="c1"># Key &quot;last_name&quot;, value &quot;Hartl&quot;</span>
<span class="go">=&gt; &quot;Hartl&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">[</span><span class="s2">&quot;first_name&quot;</span><span class="o">]</span>                 <span class="c1"># Element access is like arrays.</span>
<span class="go">=&gt; &quot;Michael&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span>                               <span class="c1"># A literal representation of the hash</span>
<span class="go">=&gt; {&quot;last_name&quot;=&gt;&quot;Hartl&quot;, &quot;first_name&quot;=&gt;&quot;Michael&quot;}</span>
</pre></div>
</div>


<p>ハッシュはキーと値のペアを波括弧によって示します; キーと値のペアを持たない括弧の組—すなわち、<code>{}</code>—は空のハッシュです。重要な留意するべき点は、ハッシュのための波括弧は、ブロックのための波括弧とは関係無いということです。(そう、混乱するかもしれません) ハッシュは配列と似ているけれども、1つの重要な違いはハッシュは要素の並び順の保証を通常はしないということです。<sup class="footnote" id="fnref-4_8"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_8">8</a></sup> もし順番が重要ならば、配列を使ってください。</p>

<p>ハッシュの1要素を角括弧を使って定義する代わりに、キーと値をハッシュロケットと呼ばれる<code>=&gt;</code> によってリテラル表現するほうが簡単です:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;first_name&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Michael&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Hartl&quot;</span> <span class="p">}</span>
<span class="go">=&gt; {&quot;last_name&quot;=&gt;&quot;Hartl&quot;, &quot;first_name&quot;=&gt;&quot;Michael&quot;}</span>
</pre></div>
</div>


<p>ここでは Ruby における通常の慣習としてハッシュの最初と最後に空白を追加しています—この慣習はコンソールによって無視されています。(なぜスペースを置くのか私に訊かないでください; おそらく初期の有力な Ruby プログラマ がこの見た目を好み、そして慣習となったのでしょう。)</p>

<p>これまでのところハッシュのキーとして文字列を使ってきましたが、 Rails は代わりに<em>シンボル</em>を共通してよく使います。シンボルは文字列のように見えますが、クオートで囲む代わりにコロンが前に置かれています。例えば、<code>:name</code>はシンボルです。全ての余計な手荷物なしであなたは基本的にシンボルを文字列と考えることができます:<sup class="footnote" id="fnref-4_9"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_9">9</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s2">&quot;name&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">=&gt; [&quot;n&quot;, &quot;a&quot;, &quot;m&quot;, &quot;e&quot;]</span>
<span class="gp">&gt;&gt; </span><span class="ss">:name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">NoMethodError: undefined method `split&#39; for :name:Symbol</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;foobar&quot;</span><span class="o">.</span><span class="n">reverse</span>
<span class="go">=&gt; &quot;raboof&quot;</span>
<span class="gp">&gt;&gt; </span><span class="ss">:foobar</span><span class="o">.</span><span class="n">reverse</span>
<span class="go">NoMethodError: undefined method `reverse&#39; for :foobar:Symbol</span>
</pre></div>
</div>


<p>シンボルは、他のごく一部の言語でも使われている Ruby の特殊なデータ形式で、最初は奇妙に思うかもしれませんが、しかし Rails はこれをたくさん使い、そしてあなたもすぐに慣れることでしょう。</p>

<p>ハッシュのキーとしてのシンボルに関して、 <code>user</code> のハッシュは下記のように定義できます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">&quot;Michael Hartl&quot;</span><span class="p">,</span> <span class="ss">:email</span> <span class="o">=&gt;</span> <span class="s2">&quot;michael@example.com&quot;</span> <span class="p">}</span>
<span class="go">=&gt; {:name=&gt;&quot;Michael Hartl&quot;, :email=&gt;&quot;michael@example.com&quot;}</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span>              <span class="c1"># Access the value corresponding to :name.</span>
<span class="go">Michael Hartl</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">[</span><span class="ss">:password</span><span class="o">]</span>          <span class="c1"># Access the value of an undefined key.</span>
<span class="go">=&gt; nil</span>
</pre></div>
</div>


<p>最後の例より、定義されていないハッシュの値は単純に<code>nil</code> であることがわかります。</p>

<p>ハッシュではシンボルをキーとして使うことが一般的なので、Ruby 1.9 ではこのような特殊な場合のための新しい記法をサポートしています:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">h1</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s2">&quot;Michael Hartl&quot;</span><span class="p">,</span> <span class="ss">:email</span> <span class="o">=&gt;</span> <span class="s2">&quot;michael@example.com&quot;</span> <span class="p">}</span>
<span class="go">=&gt; {:name=&gt;&quot;Michael Hartl&quot;, :email=&gt;&quot;michael@example.com&quot;}</span>
<span class="gp">&gt;&gt; </span><span class="n">h2</span> <span class="o">=</span> <span class="p">{</span> <span class="nb">name</span><span class="p">:</span> <span class="s2">&quot;Michael Hartl&quot;</span><span class="p">,</span> <span class="ss">email:</span> <span class="s2">&quot;michael@example.com&quot;</span> <span class="p">}</span>
<span class="go">=&gt; {:name=&gt;&quot;Michael Hartl&quot;, :email=&gt;&quot;michael@example.com&quot;} </span>
<span class="gp">&gt;&gt; </span><span class="n">h1</span> <span class="o">==</span> <span class="n">h2</span>
<span class="go">=&gt; true</span>
</pre></div>
</div>


<p>2つ目の記法はシンボルとハッシュロケットの組み合わせをキーの名前に続いてコロンと値がくるように置き換えたものです:</p>

<div class="code"><div class="highlight"><pre><span class="p">{</span> <span class="nb">name</span><span class="p">:</span> <span class="s2">&quot;Michael Hartl&quot;</span><span class="p">,</span> <span class="ss">email:</span> <span class="s2">&quot;michael@example.com&quot;</span> <span class="p">}</span>
</pre></div>
</div>


<p>この構造は他の言語でのハッシュ記法により近いです ( JavaScript のような ) そして Rails コミュニティで人気になってきています。両方の記法がまだよく使われているので、両方の見分けがつくことが重要です。他の章で、ほとんどのハッシュは新しい記法を用いており、これは Ruby 1.8.7 以前では動きません; もしあなたが Ruby の古いバージョンを使っているのならば Ruby 1.9 に更新 ( こちらを薦めます )、　もしくは古い記法を使わなければなりません。</p>

<p><a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-nested_hashes">Listing 4.6</a> からわかるように、ハッシュの値はほとんどなんでもよく、他のハッシュですら用いることができます。</p>

<div class="label" id="code-nested_hashes"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.6.</span> <span class="description">Nested hashes.</span> </div>
<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># Define a hash called &#39;params&#39; (short for &#39;parameters&#39;).</span>
<span class="go">=&gt; {}</span>
<span class="gp">&gt;&gt; </span><span class="n">params</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span> <span class="nb">name</span><span class="p">:</span> <span class="s2">&quot;Michael Hartl&quot;</span><span class="p">,</span> <span class="ss">email:</span> <span class="s2">&quot;mhartl@example.com&quot;</span> <span class="p">}</span>
<span class="go">=&gt; {:name=&gt;&quot;Michael Hartl&quot;, :email=&gt;&quot;mhartl@example.com&quot;}</span>
<span class="gp">&gt;&gt; </span><span class="n">params</span>
<span class="go">=&gt; {:user=&gt;{:name=&gt;&quot;Michael Hartl&quot;, :email=&gt;&quot;mhartl@example.com&quot;}}</span>
<span class="gp">&gt;&gt; </span> <span class="n">params</span><span class="o">[</span><span class="ss">:user</span><span class="o">][</span><span class="ss">:email</span><span class="o">]</span>
<span class="go">=&gt; &quot;mhartl@example.com&quot;</span>
</pre></div>
</div></div>


<p>これらハッシュのハッシュや、 <em>ネストされたハッシュ</em> はRails で大量に使われるということを <a class="ref" href="http://railstutorial.jp/sign-up.html#sec-signup_failure">7.3</a> から知ることになります。</p>

<p>配列や範囲オブジェクトのように、ハッシュは <code>each</code> メソッドに応答します。例えば、 <code>:success</code> と<code>:error</code> という 2つの状態を持つ <code>flash</code> という名前のハッシュについて考えてみましょう:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">flash</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">success:</span> <span class="s2">&quot;It worked!&quot;</span><span class="p">,</span> <span class="ss">error:</span> <span class="s2">&quot;It failed.&quot;</span> <span class="p">}</span>
<span class="go">=&gt; {:success=&gt;&quot;It worked!&quot;, :error=&gt;&quot;It failed.&quot;}</span>
<span class="gp">&gt;&gt; </span><span class="n">flash</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
<span class="gp">?</span><span class="gp">&gt; </span>  <span class="nb">puts</span> <span class="s2">&quot;Key </span><span class="si">#{</span><span class="n">key</span><span class="o">.</span><span class="n">inspect</span><span class="si">}</span><span class="s2"> has value </span><span class="si">#{</span><span class="n">value</span><span class="o">.</span><span class="n">inspect</span><span class="si">}</span><span class="s2">&quot;</span>
end
<span class="go">Key :success has value &quot;It worked!&quot;</span>
<span class="go">Key :error has value &quot;It failed.&quot;</span>
</pre></div>
</div>


<p>留意すべきは、配列における <code>each</code> メソッドのブロックは1つだけ変数を持ちますが、ハッシュでの <code>each</code> は<em>キー</em> と <em>値</em> の2つを持ちます。このように、 ハッシュの <code>each</code> メソッドはハッシュの1つのキーと値の <em>ペア</em> を介して繰り返します。</p>

<p>最後の例は便利な <code>inspect</code> メソッドで、これは要求されたオブジェクトを表現した文字列を返します。</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span>            <span class="c1"># Put an array as a string.</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">4</span>
<span class="go">5</span>
<span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">inspect</span>    <span class="c1"># Put a literal array.</span>
<span class="go">[1, 2, 3, 4, 5]</span>
<span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:name</span><span class="o">.</span><span class="n">inspect</span>
<span class="go">name</span>
<span class="go">:name</span>
<span class="gp">&gt;&gt; </span><span class="nb">puts</span> <span class="s2">&quot;It worked!&quot;</span><span class="p">,</span> <span class="s2">&quot;It worked!&quot;</span><span class="o">.</span><span class="n">inspect</span>
<span class="go">It worked!</span>
<span class="go">&quot;It worked!&quot;</span>
</pre></div>
</div>


<p>ところで、<code>inspect</code> をオブジェクトを表示するために用いることは非常によくあることなので、 <code>p</code> 関数というショートカットがあります:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="nb">p</span> <span class="ss">:name</span>             <span class="c1"># Same as &#39;puts :name.inspect&#39;</span>
<span class="go">:name</span>
</pre></div>
</div>




<div class="label" id="sec-css_revisited"></div>


<h3><a id="sec-4_3_4" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-css_revisited" class="heading"><span class="number">4.3.4</span> CSS、再び</a></h3>


<p>それでは<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-application_layout_redux">Listing 4.1</a>の レイアウトで連鎖したスタイルシートのを含めるために使った行に戻ってみましょう:</p>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span> <span class="cp">%&gt;</span>
</pre></div>
</div>


<p>今ならこれを理解できる段階にあります。手短に <a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-motivation">4.1</a>で述べたように、 Rails はスタイルシートを含めるための特別な関数を定義しており、また</p>

<div class="code"><div class="highlight"><pre><span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span>
</pre></div>
</div>


<p>この関数を呼んでいます。しかし、2つの不思議なことがあります。1つ目、丸括弧はどこでしょう?Ruby では、これは任意です; これら2行は同じです:</p>

<div class="code"><div class="highlight"><pre><span class="c1"># Parentheses on function calls are optional.</span>
<span class="n">stylesheet_link_tag</span><span class="p">(</span><span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span>
</pre></div>
</div>


<p>2つ目、<code>:media</code> 引数はハッシュのように見えますが、しかし波括弧はどこでしょう?ハッシュが関数呼び出しでの<em>最後の</em> 引数ならば、波括弧は任意です; これら2行は同じです。</p>

<div class="code"><div class="highlight"><pre><span class="c1"># Curly braces on final hash arguments are optional.</span>
<span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span> <span class="p">}</span>
<span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span>
</pre></div>
</div>


<p>なので、この行は</p>

<div class="code"><div class="highlight"><pre><span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&gt;</span> <span class="s2">&quot;all&quot;</span>
</pre></div>
</div>


<p><code>stylesheet_link_tag</code> 関数を2つの引数で呼んでいます: 文字列はスタイルシートへのパスを示しており、そしてハッシュはメディアタイプを示しています。<tt class="verb">&lt;%= %&gt;</tt> によって、結果は ERb によるテンプレートに挿入されます、そしてもしブラウザ上でこのページのソースを表示したならば、含める必要があるスタイルシートを見ることができるでしょう (<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-scss_source">Listing 4.7</a>)。( CSS のファイル名の後の<code>?body=1</code>のように、いくつかの物も追加で見えるかもしれませんこれらは、Rails によって、サーバ上で変更があった祭に CSS が再読み込みされることを保証するために挿入されています。 )</p>

<div class="label" id="code-scss_source"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.7.</span> <span class="description">The HTML source produced by the CSS includes.</span> </div>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;/assets/application.css&quot;</span> <span class="na">media=</span><span class="s">&quot;all&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span>
<span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div></div>


<p>もし実際に CSS ファイルを <a href="http://localhost:3000/assets/application.css">http://localhost:3000/assets/application.css</a> にアクセスして見たならば、(いくつかのコメントはさておき) それは空だと分かるでしょう。これの変更を<a class="ref" href="http://railstutorial.jp/filling-in-the-layout.html#top">5章</a>で行います。</p>

<div class="label" id="sec-ruby_classes"></div>


<h2><a id="sec-4_4" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-ruby_classes" class="heading"><span class="number">4.4</span> Ruby におけるクラス</a></h2>


<p>先程、Ruby でのあらゆるものはオブジェクトであると説明しましたが、この章ではついに自分たちでいくつかを定義します。 Rubyは、多くのオブジェクト指向言語のように、メソッドをまとめるために<em>クラス</em>を使います; これらクラスはそのときオブジェクトを作るために<em>インスタンスを作ります</em>。もしあなたがオブジェクト指向プログラミングが初めてならば、これはわけがわからないでしょう、なのでいくつかの具体的な例を見てみましょう。</p>

<div class="label" id="sec-constructors"></div>


<h3><a id="sec-4_4_1" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-constructors" class="heading"><span class="number">4.4.1</span>コンストラクタ</a></h3>


<p>オブジェクトのインスタンスを作成するためにクラスを使う多くの例を見てきましたが、まだはっきりとはしていません。例えば、ダブルクオートを使って文字列のインスタンスを作成しましたが、これは文字列の<em>リテラルコンストラクタ</em>です:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;foobar&quot;</span>       <span class="c1"># A literal constructor for strings using double quotes</span>
<span class="go">=&gt; &quot;foobar&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">class</span>
<span class="go">=&gt; String</span>
</pre></div>
</div>


<p>ここでは、文字列は<code>class</code>メソッドに応答しており、そして単純にそれが所属するクラスを返していることがわかります。</p>

<p>リテラルコンストラクタを使う代わりに、同等の <em>名前付きコンストラクタ</em>を使うことができます、これはクラス名に対して<code>new</code> メソッドを呼びだします:<sup class="footnote" id="fnref-4_10"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_10">10</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="nb">String</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foobar&quot;</span><span class="p">)</span>   <span class="c1"># A named constructor for a string</span>
<span class="go">=&gt; &quot;foobar&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">class</span>
<span class="go">=&gt; String</span>
<span class="gp">&gt;&gt; </span><span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;foobar&quot;</span>
<span class="go">=&gt; true</span>
</pre></div>
</div>


<p>これはリテラルコンストラクタと同じですが、何をするかが明白です。</p>

<p>配列も文字列と同じように働きます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">]</span><span class="p">)</span>
<span class="go">=&gt; [1, 3, 2]</span>
</pre></div>
</div>


<p>ハッシュは、対比的に、異なっています。配列のコンストラクタである<code>Array.new</code> は配列の初期値を取りますが、 <code>Hash.new</code> はハッシュの<em>デフォルト</em> 値を取ります、これは存在しないキーに対する値です:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span>
<span class="go">=&gt; {}</span>
<span class="gp">&gt;&gt; </span><span class="n">h</span><span class="o">[</span><span class="ss">:foo</span><span class="o">]</span>            <span class="c1"># Try to access the value for the nonexistent key :foo.</span>
<span class="go">=&gt; nil</span>
<span class="gp">&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="no">Hash</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="c1"># Arrange for nonexistent keys to return 0 instead of nil.</span>
<span class="go">=&gt; {}</span>
<span class="gp">&gt;&gt; </span><span class="n">h</span><span class="o">[</span><span class="ss">:foo</span><span class="o">]</span>
<span class="go">=&gt; 0</span>
</pre></div>
</div>


<p>この場合の<code>new</code>のように、クラス自身のメソッドが呼ばれたとき、 <em>クラスメソッド</em> が呼ばれます。クラスの<code>new</code> を呼び出した結果はそのクラスのオブジェクトで、これはクラスの<em>インスタンス</em> とも呼ばれます。<code>length</code>のようなインスタンスに対して呼び出すメソッドは <em>インスタンスメソッド</em>と呼ばれます。</p>

<div class="label" id="sec-a_class_of_our_own"></div>


<h3><a id="sec-4_4_2" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-a_class_of_our_own" class="heading"><span class="number">4.4.2</span>クラス継承</a></h3>


<p>クラスについて学ぶとき、<code>superclass</code> メソッドを使って<em>クラス階層</em> について調べることが便利です:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="nb">String</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;foobar&quot;</span><span class="p">)</span>
<span class="go">=&gt; &quot;foobar&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">class</span>                        <span class="c1"># Find the class of s.</span>
<span class="go">=&gt; String</span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span>             <span class="c1"># Find the superclass of String.</span>
<span class="go">=&gt; Object</span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span>  <span class="c1"># Ruby 1.9 uses a new BasicObject base class</span>
<span class="go">=&gt; BasicObject </span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span>
<span class="go">=&gt; nil</span>
</pre></div>
</div>


<p>継承階層の図を<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#fig-string_inheritance_ruby_1_9">図 4.1</a>に示します。ここでは、<code>String</code> のスーパークラスは <code>Object</code> で、<code>Object</code> のスーパークラスは <code>BasicObject</code>ですが、 <code>BasicObject</code> はスーパークラスを持たないことがわかります。この様式は全ての Ruby のオブジェクトにおいて成り立ちます: クラス階層を十分に追跡していくと、 Ruby における全てのクラスは最終的には、スーパークラスを持たない<code>BasicObject</code> を継承しています。これは &quot;Ruby において あらゆるものはオブジェクトである&quot; ということの技術的な意味です。</p>

<div class="label" id="fig-string_inheritance_ruby_1_9"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="http://railstutorial.jp/images/figures/string_inheritance_ruby_1_9.png" alt="string_inheritance_ruby_1_9" /></span></div><div class="caption"><span class="header">図 4.1: </span><span class="description"> <code>String</code> クラスの継承階層</span></div></div>


<p>クラスについてもう少し深く知るためには、自分自身で作ってみるに代わるものはありません。単語が前と後ろとどちらから読んでも同じならば<code>true</code>を返す、<code>palindrome?</code> メソッドを持つ<code>Word</code> クラスを作ってみましょう。</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="k">class</span> <span class="nc">Word</span>
<span class="gp">&gt;&gt; </span>  <span class="k">def</span> <span class="nf">palindrome?</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="gp">&gt;&gt; </span>    <span class="n">string</span> <span class="o">==</span> <span class="n">string</span><span class="o">.</span><span class="n">reverse</span>
end
end
<span class="go">=&gt; nil</span>
</pre></div>
</div>


<p>これは以下のように使うことができます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="no">Word</span><span class="o">.</span><span class="n">new</span>              <span class="c1"># Make a new Word object.</span>
<span class="go">=&gt; #&lt;Word:0x22d0b20&gt;</span>
<span class="gp">&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">palindrome?</span><span class="p">(</span><span class="s2">&quot;</span><span class="s2">foobar&quot;</span><span class="p">)</span>
<span class="go">=&gt; false</span>
<span class="gp">&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">palindrome?</span><span class="p">(</span><span class="s2">&quot;</span><span class="s2">level&quot;</span><span class="p">)</span>
<span class="go">=&gt; true</span>
</pre></div>
</div>


<p>もしこの例が少し不自然に思えるならば、鋭いです; これは設計によるものです。文字列を引数に取るメソッドを作るためだけに新しいクラスを作るのは変です。単語<em>は</em> 文字列なので、<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-word_class">Listing 4.8</a>のように、<code>Word</code> クラスは <code>String</code>クラスを<em>継承</em>するのが自然です。(古い<code>Word</code> の定義を消すために、あなたはコンソールを終了して、入りなおすべきでしょう。)</p>

<div class="label" id="code-word_class"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.8.</span> <span class="description">コンソールでの<code>Word</code> クラスの定義です。</span> </div>
<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="k">class</span> <span class="nc">Word</span> <span class="o">&lt;</span> <span class="nb">String</span>             <span class="c1"># Word inherits from String.</span>
<span class="gp">&gt;&gt; </span>  <span class="c1"># Returns true if the string is its own reverse.</span>
<span class="gp">&gt;&gt; </span>  <span class="k">def</span> <span class="nf">palindrome?</span>
<span class="gp">&gt;&gt; </span>    <span class="nb">self</span> <span class="o">==</span> <span class="nb">self</span><span class="o">.</span><span class="n">reverse</span>        <span class="c1"># self is the string itself.</span>
end
end
<span class="go">=&gt; nil</span>
</pre></div>
</div></div>


<p>ここでの <code>Word &lt; String</code> は継承のための Ruby の記法で(<a class="ref" href="http://railstutorial.jp/static-pages.html#sec-static_pages_with_rails">3.1.2</a> で手短に話しました)、これは新しい <code>palindrome?</code> メソッドに加えて、単語がまた文字列と同じ全てのメソッドを持つことを保証します:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="no">Word</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;level&quot;</span><span class="p">)</span>    <span class="c1"># Make a new Word, initialized with &quot;level&quot;.</span>
<span class="go">=&gt; &quot;level&quot;                  </span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">palindrome?</span>            <span class="c1"># Words have the palindrome? </span><span class="c1">method.</span>
<span class="go">=&gt; true                     </span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">length</span>                 <span class="c1"># Words also inherit all the normal string methods.</span>
<span class="go">=&gt; 5</span>
</pre></div>
</div>


<p><code>Word</code> クラスは<code>String</code>を継承しているので、コンソールをクラス階層を明白に知るために使うことができます:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">class</span>
<span class="go">=&gt; Word</span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span>
<span class="go">=&gt; String</span>
<span class="gp">&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span>
<span class="go">=&gt; Object</span>
</pre></div>
</div>


<p><a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#fig-word_inheritance_ruby_1_9">図 4.2</a>にこの階層を示します。</p>

<div class="label" id="fig-word_inheritance_ruby_1_9"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="http://railstutorial.jp/images/figures/word_inheritance_ruby_1_9.png" alt="word_inheritance_ruby_1_9" /></span></div><div class="caption"><span class="header">図 4.2: </span><a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-word_class">Listing 4.8</a>での<span class="description">(組み込みではない) <code>Word</code> クラスの継承階層</span></div></div>


<p><a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-word_class">Listing 4.8</a>で留意すべきは word は自身の reverse を呼び出し note that checking that the word is its own reverse involves accessing the word inside the <code>Word</code> クラス内の word にアクセスして. Ruby はこれを<code>self</code> キーワードを使うことでできます: <code>Word</code> クラスの中で、<code>self</code> はオブジェクト自身で、これは</p>

<div class="code"><div class="highlight"><pre><span class="nb">self</span> <span class="o">==</span> <span class="nb">self</span><span class="o">.</span><span class="n">reverse</span>
</pre></div>
</div>


<p>を単語が回文であるか確かめるために使えることを意味します。<sup class="footnote" id="fnref-4_11"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_11">11</a></sup></p>

<div class="label" id="sec-modifying_built_in_classes"></div>


<h3><a id="sec-4_4_3" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-modifying_built_in_classes" class="heading"><span class="number">4.4.3</span>組込みクラスの変更</a></h3>


<p>継承は強力な考え方ですが、この場合にはもっと自然に <code>palindrome?</code> メソッドを<code>String</code> クラス自身に追加さえできます、なので (とりわけ)  <code>palindrome?</code> をリテラル文字列に対して呼べます、今のところはできませんが:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s2">&quot;level&quot;</span><span class="o">.</span><span class="n">palindrome?</span>
<span class="go">NoMethodError: undefined method `palindrome?&#39; </span><span class="go">for &quot;level&quot;:String</span>
</pre></div>
</div>


<p>驚くべきことに、 Ruby はこれができます; Ruby のクラスは<em>開くことができ</em> そして変更でき、私たちのような平凡な人にでもこれらにメソッドを追加することが許されています:<sup class="footnote" id="fnref-4_12"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_12">12</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="k">class</span> <span class="nc">String</span>
<span class="gp">&gt;&gt; </span>  <span class="c1"># Returns true if the string is its own reverse.</span>
<span class="gp">&gt;&gt; </span>  <span class="k">def</span> <span class="nf">palindrome?</span>
<span class="gp">&gt;&gt; </span>    <span class="nb">self</span> <span class="o">==</span> <span class="nb">self</span><span class="o">.</span><span class="n">reverse</span>
end
end
<span class="go">=&gt; nil</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;deified&quot;</span><span class="o">.</span><span class="n">palindrome?</span>
<span class="go">=&gt; true</span>
</pre></div>
</div>


<p>(私はどちらが優れているか知りません: Ruby では組み込みクラスにメソッドを追加することも、<code>&quot;deified&quot;</code> が回文.)</p>

<p>組み込みクラスを変更することは強力なテクニックですが、大いなる力には大いなる責任が伴い、そして<em>本当に</em> そうするだけの良い理由無しに組み込みクラスにメソッドを追加することは無作法だと考えられています。Rails はいくつかの良い理由を持っています; 例えば、Web アプリケーションにおいてたびたび変数が<em>空白</em>であることを防止したいです—例えば、ユーザの名前はスペースや<a href="http://en.wikipedia.org/wiki/Whitespace_(computer_science)">空白類文字</a>以外であるべきです—なので、Rails は<code>blank?</code>を Ruby に追加しています。Rails コンソールは自動的に Rails の拡張を含めるので、ここに例を見ることができます (これは純粋な <code>irb</code> では動きません):</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">blank?</span>
<span class="go">=&gt; true</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;      &quot;</span><span class="o">.</span><span class="n">empty?</span>
<span class="go">=&gt; false</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;      &quot;</span><span class="o">.</span><span class="n">blank?</span>
<span class="go">=&gt; true</span>
<span class="gp">&gt;&gt; </span><span class="kp">nil</span><span class="o">.</span><span class="n">blank?</span>
<span class="go">=&gt; true</span>
</pre></div>
</div>


<p>文字列は<em>空(empty)</em>ではないですが、これは<em>空白(blank)</em>であることがわかります。また、留意すべきは<code>nil</code>は空白であることです;<code>nil</code> は文字列ではないので、これは Rails が実際には<code>blank?</code> を <code>String</code>の基本クラスに追加していることのヒントになり、これは (この章の最初に見ました) <code>Object</code> 自身です。<a class="ref" href="http://railstutorial.jp/sign-in-sign-out.html#sec-remember_me">8.2.1</a> で、Rails が Ruby のクラスに追加している他の例について知ることになります。</p>

<div class="label" id="sec-a_controller_class"></div>


<h3><a id="sec-4_4_4" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-a_controller_class" class="heading"><span class="number">4.4.4</span>コントローラクラス</a></h3>


<p>クラスや継承についての話についての全ては見覚えがあるかもしれません、なぜなら両方とも以前、StaticPages コントローラで見たのですから (<a class="ref" href="http://railstutorial.jp/static-pages.html#code-adding_the_about_page">リスト 3.15</a>):</p>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">StaticPagesController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">home</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">help</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">about</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>


<p>あなたは今なら十分に、少なくとも漠然と、このコードが何を意味しているかを理解することができます: <code>StaticPagesController</code> は <code>ApplicationController</code>を継承したクラスで、<code>home</code>、<code>help</code>や <code>about</code> メソッドを備えています。 それぞれの Rails コンソールのセッションはローカルの Rails 環境を読み込むので、明示的にコントローラを作ったり、それのクラス階層を調べたりすることができます: <sup class="footnote" id="fnref-4_13"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_13">13</a></sup></p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">controller</span> <span class="o">=</span> <span class="no">StaticPagesController</span><span class="o">.</span><span class="n">new</span>
<span class="go">=&gt; #&lt;StaticPagesController:0x22855d0&gt;</span>
<span class="gp">&gt;&gt; </span><span class="n">controller</span><span class="o">.</span><span class="n">class</span>
<span class="go">=&gt; StaticPagesController</span>
<span class="gp">&gt;&gt; </span><span class="n">controller</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span>
<span class="go">=&gt; ApplicationController</span>
<span class="gp">&gt;&gt; </span><span class="n">controller</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span>
<span class="go">=&gt; ActionController::Base</span>
<span class="gp">&gt;&gt; </span><span class="n">controller</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span>
<span class="go">=&gt; ActionController::Metal</span>
<span class="gp">&gt;&gt; </span><span class="n">controller</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span>
<span class="go">=&gt; AbstractController::Base</span>
<span class="gp">&gt;&gt; </span><span class="n">controller</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span><span class="o">.</span><span class="n">superclass</span>
<span class="go">=&gt; Object</span>
</pre></div>
</div>


<p>継承の一覧を <a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#fig-static_pages_controller_inheritance">図 4.3</a>に示します。</p>

<div class="label" id="fig-static_pages_controller_inheritance"></div>


<div class="figure"><div class="center"><span class="graphic"><img src="http://railstutorial.jp/images/figures/static_pages_controller_inheritance.png" alt="static_pages_controller_inheritance" /></span></div><div class="caption"><span class="header">図 4.3: </span><span class="description"> StaticPages コントローラの継承階層</span></div></div>


<p>コンソールの中から、コントローラのアクションですら呼ぶことができます、これはただのメソッドです:</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">controller</span><span class="o">.</span><span class="n">home</span>
<span class="go">=&gt; nil</span>
</pre></div>
</div>


<p>ここでは<code>home</code> アクションは空なので<code>nil</code>が返されています。</p>

<p>しかし待ってください—アクションは戻り値を持ちません、少なくとも重要な1つのものがないです。<code>home</code> アクションにおけるポイントは、<a class="ref" href="http://railstutorial.jp/static-pages.html#top">3章</a>で見たように、Webページを表示するのに、値を返しません。そして <code>StaticPagesController.new</code> はどこからも呼ばれていません。何が起きているのでしょう?</p>

<p>何が起きているかというと、 Rails は Ruby で <em>書かれて</em> いますが、Rails は Ruby ではないということです。いくつかの Rails のクラスは普通の Ruby のオブジェクトのように使われますが、またいくつかは<a href="http://www.answers.com/grist">grist</a> for Rails’ magic mill. Rails は <a href="http://en.wikipedia.org/wiki/Sui_generis"><em>独特(sui generis)</em></a> なので、 Ruby とは離れて学び、理解されるべきです。この理由で、もしあなたの主な興味が Web アプリを書くことならば、最初に Rails を学び、その後 Ruby を学び、また Rails に戻ってくることをおすすめします。</p>

<div class="label" id="sec-a_user_class"></div>


<h3><a id="sec-4_4_5" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-a_user_class" class="heading"><span class="number">4.4.5</span>ユーザークラス</a></h3>


<p>Ruby のツアーを、完全に自分で作ったクラス、 <code>User</code> クラスで終わらせます、これは<a class="ref" href="http://railstutorial.jp/modeling-users.html#top">6章</a> で出てくる予定です。</p>

<p>これまでのところコンソールからクラス定義をしてきましたが、これは急速に面倒になります; それよりも、アプリケーションルートディレクトリに <code>example_user.rb</code> を作って<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-example_user">リスト4.9</a> のように書きましょう。</p>

<div class="label" id="code-example_user"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.9.</span> <span class="description">ユーザの例のコードです。</span><br /><span class="description"> <code>example_user.rb</code></span> </div>
<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span>
  <span class="kp">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">attributes</span> <span class="o">=</span> <span class="p">{})</span>
    <span class="vi">@name</span>  <span class="o">=</span> <span class="n">attributes</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span>
    <span class="vi">@email</span> <span class="o">=</span> <span class="n">attributes</span><span class="o">[</span><span class="ss">:email</span><span class="o">]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">formatted_email</span>
    <span class="s2">&quot;</span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2"> &lt;</span><span class="si">#{</span><span class="vi">@email</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div></div>


<p>これは全く大きくはないので、段階的に見て行きましょう。最初の行、</p>

<div class="code"><div class="highlight"><pre>  <span class="kp">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span>
</pre></div>
</div>


<p>ユーザの名前とメールアドレスに応答する <em>アトリビュート アクセサ</em> を作ります。これは <a class="ref" href="http://railstutorial.jp/a-demo-app.html#sec-mvc_in_action">2.2.2</a> で述べたように、<code>@name</code> と<code>@email</code> という <em>インスタンス変数</em>を取り出し(get) 割り当てる(set)  &quot;ゲッター&quot; と &quot;セッター&quot; というメソッドを作ります。Rails では、インスタンス変数の主な重要性はビューで自動的に使えるということですが、一般的にはこれらは Ruby のクラスの全体にわたって利用可能である必要がある変数に使われます。(この瞬間にもう少し言うことがあります。) インスタンス変数はいつも <code>@</code> 記号で始まり、定義されていない場合は<code>nil</code>です。</p>

<p>最初のメソッド、 <code>initialize</code> はRuby では特殊です: これは <code>User.new</code> を実行した際に呼ばれるメソッドです。この特定の <code>initialize</code> は<code>attributes</code>という引数を1つ取ります:</p>

<div class="code"><div class="highlight"><pre>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">attributes</span> <span class="o">=</span> <span class="p">{})</span>
    <span class="vi">@name</span>  <span class="o">=</span> <span class="n">attributes</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span>
    <span class="vi">@email</span> <span class="o">=</span> <span class="n">attributes</span><span class="o">[</span><span class="ss">:email</span><span class="o">]</span>
  <span class="k">end</span>
</pre></div>
</div>


<p>ここでは <code>attributes</code> 変数は空のハッシュを <em>デフォルトの値</em> として持つため、名前やメールアドレスのないユーザを作ることができます (<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-hashes_and_symbols">4.3.3</a> を思い出してください。存在しないキーに対してハッシュは <code>nil</code> を返すので、  <code>:name</code> キーがなければ<code>attributes[:name]</code> は <code>nil</code> になり、同じことが <code>attributes[:email]</code> にも言えます)。</p>

<p>最後に、割り当てられた<code>@name</code> と <code>@email</code> の値を使った文字列の挿入によってうまく構成されたユーザのメールアドレスを組み立てる<code>formatted_email</code> メソッドを定義しましょう (<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-strings">4.2.2</a>):</p>

<div class="code"><div class="highlight"><pre>  <span class="k">def</span> <span class="nf">formatted_email</span>
    <span class="s2">&quot;</span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2"> &lt;</span><span class="si">#{</span><span class="vi">@email</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
  <span class="k">end</span>
</pre></div>
</div>


<p><code>@name</code> と <code>@email</code> は両方ともインスタンス変数 ( <code>@</code> 記号によって示されています)で、自動的に <code>formatted_email</code> メソッドで使えるようになります。</p>

<p>コンソールを起動し、example user のコードを<code>require</code>して、自作したクラスを試しに使ってみましょう。</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="nb">require</span> <span class="s1">&#39;./example_user&#39;</span>     <span class="c1"># This is how you load the example_user code.</span>
<span class="go">=&gt; [&quot;User&quot;]</span>
<span class="gp">&gt;&gt; </span><span class="n">example</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span>
<span class="go">=&gt; #&lt;User:0x224ceec @email=nil, @name=nil&gt;</span>
<span class="gp">&gt;&gt; </span><span class="n">example</span><span class="o">.</span><span class="n">name</span>                 <span class="c1"># nil since attributes[:name] is nil</span>
<span class="go">=&gt; nil</span>
<span class="gp">&gt;&gt; </span><span class="n">example</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Example User&quot;</span>           <span class="c1"># Assign a non-nil name</span>
<span class="go">=&gt; &quot;Example User&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">example</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="s2">&quot;user@example.com&quot;</span>      <span class="c1"># and a non-nil email address</span>
<span class="go">=&gt; &quot;user@example.com&quot;</span>
<span class="gp">&gt;&gt; </span><span class="n">example</span><span class="o">.</span><span class="n">formatted_email</span>
<span class="go">=&gt; &quot;Example User &lt;user@example.com&gt;&quot;</span>
</pre></div>
</div>


<p>この <code>’.’</code> は Unix の “カレントディレクトリ”のことで、<code>’./example_user’</code> は Ruby に相対パスで example user ファイルを探すように伝えています。その後、コードは空の example user を作り、そして属性に直接代入することで名前とメールアドレスに書き込みをしています (<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-example_user">リスト 4.9</a>の<code>attr_accessor</code>によって代入ができるようになっています)。下記のように書いたとき</p>

<div class="code"><div class="highlight"><pre><span class="n">example</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Example User&quot;</span>
</pre></div>
</div>


<p>Ruby は <code>@name</code> 変数 に <code>&quot;Example User&quot;</code> (そして同じく<code>email</code> 属性にも) を設定しており、これは<code>formatted_email</code> メソッドで使われます。</p>

<p><a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-css_revisited">4.3.4</a> を思い出すと、最後のハッシュ引数の波括弧を省略でき、前もって定義された属性を持つユーザを作るために<code>initialize</code> メソッドにハッシュを渡すことで他のユーザを作ることができます。</p>

<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">name</span><span class="p">:</span> <span class="s2">&quot;Michael Hartl&quot;</span><span class="p">,</span> <span class="ss">email:</span> <span class="s2">&quot;mhartl@example.com&quot;</span><span class="p">)</span>
<span class="go">=&gt; #&lt;User:0x225167c @email=&quot;mhartl@example.com&quot;, @name=&quot;Michael Hartl&quot;&gt;</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">formatted_email</span>
<span class="go">=&gt; &quot;Michael Hartl &lt;mhartl@example.com&gt;&quot;</span>
</pre></div>
</div>


<p><a class="ref" href="http://railstutorial.jp/sign-up.html#top">7章</a> では、 Rails アプリケーションで一般的な <em>mass assignment</em>として知られるテクニックであるハッシュ引数によるオブジェクトの初期化について知ることになります。</p>

<div class="label" id="sec-conclusion"></div>


<h2><a id="sec-4_5" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-conclusion" class="heading"><span class="number">4.5</span>最後に</a></h2>


<p>ここで、Ruby 言語の概要について終わりにします。<a class="ref" href="http://railstutorial.jp/filling-in-the-layout.html#top">5章</a>では、サンプルアプリケーションの開発において学んだ内容を生かしていきます。</p>

<p><a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-a_user_class">4.4.5</a>での<code>example_user.rb</code> ファイルを使うことはないので、これを削除することをお勧めします:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> rm example_user.rb
</pre></div>
</div>


<p>そしてその他の変更をリポジトリにコミットしましょう:</p>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> git add .
<span class="gp">$</span> git commit -m <span class="s2">&quot;Add a full_title helper&quot;</span>
</pre></div>
</div>




<div class="label" id="sec-exercises"></div>


<h2><a id="sec-4_6" href="http://railstutorial.jp/rails-flavored-ruby.html#sec-exercises" class="heading"><span class="number">4.6</span>演習</a></h2>




<ol>

<li>与えられた文字列をシャッフルする関数を書くために、<a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-string_shuffle">リスト 4.10</a> でのクエスチョンマークを適切なメソッドに置換することで<code>split</code>、<code>shuffle</code>、<code>join</code>を組み合わせてみましょう。</li>

<li><a class="ref" href="http://railstutorial.jp/rails-flavored-ruby.html#code-string_shuffle_two">リスト 4.11</a>のようにして<code>shuffle</code> メソッドを <code>String</code> クラスに追加してみましょう。</li>

<li><code>:first</code> と <code>:last</code> のキーの下に名前と名字を持つ、<code>person1</code>、<code>person2</code>、<code>person3</code>という3つのハッシュを作りましょう。そして <code>params</code> ハッシュを作って、 <code>params[:father]</code> は <code>person1</code>、 <code>params[:mother]</code> は <code>person2</code>、そして<code>params[:child]</code> は <code>person3</code>にしてください。そして、例えば、<code>params[:father][:first]</code> が正しい値を持っていることを確認してください。</li>

<li>Ruby API のオンラインマニュアルを見つけて、<code>Hash</code> の <code>merge</code>メソッドについて読んでみてください。</li>

<li>Ruby の悟りに到るために<a href="http://rubykoans.com/">Ruby Koans</a><sup class="footnote" id="fnref-4_14"><a href="http://railstutorial.jp/rails-flavored-ruby.html#fn-4_14">14</a></sup> に従ってみてください。</li>
</ol>




<div class="label" id="code-string_shuffle"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.10.</span> <span class="description">文字列をシャッフルする関数の骨組み</span> </div>
<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="k">def</span> <span class="nf">string_shuffle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt; </span>  <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="sc">?.</span><span class="p">?</span>
end
<span class="go">=&gt; nil</span>
<span class="gp">&gt;&gt; </span><span class="n">string_shuffle</span><span class="p">(</span><span class="s2">&quot;foobar&quot;</span><span class="p">)</span>
</pre></div>
</div></div>




<div class="label" id="code-string_shuffle_two"></div>


<div class="codelisting">
<div class="listing"><span class="header">Listing 4.11.</span> <span class="description"><code>shuffle</code> メソッドを<code>String</code> クラスに追加するための骨組み</span> </div>
<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="k">class</span> <span class="nc">String</span>
<span class="gp">&gt;&gt; </span>  <span class="k">def</span> <span class="nf">shuffle</span>
<span class="gp">&gt;&gt; </span>    <span class="nb">self</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="sc">?.</span><span class="p">?</span>
end
end
<span class="go">=&gt; nil</span>
<span class="gp">&gt;&gt; </span><span class="s2">&quot;foobar&quot;</span><span class="o">.</span><span class="n">shuffle</span>
</pre></div>
</div></div>




<div class="navigation">  <a class="prev_page" href="http://railstutorial.jp/static-pages.html#top">
</a><a class="prev_page" href="http://railstutorial.jp/static-pages.html#top"><span class="number">第3章</span>ほぼ静的なページの作成</a><a class="prev_page" href="http://railstutorial.jp/static-pages.html#top">  </a>
  <a class="next_page" href="http://railstutorial.jp/filling-in-the-layout.html#top">
</a><a class="next_page" href="http://railstutorial.jp/filling-in-the-layout.html#top">    <span class="number">第5章</span>レイアウトを作成する</a><a class="next_page" href="http://railstutorial.jp/filling-in-the-layout.html#top">  </a>
</div><div class="footnotes">
<ol>
<li id="fn-4_1">もしもヘルパが特定のコントローラのためのものであったら、一致したヘルパファイルに置くべきです; 例えば、StaticPages コントローラのためのヘルパは通常は<code>app/helpers/static_pages_helper.rb</code> になります。今回の場合では、<code>full_title</code> ヘルパをサイトの全てのページで使うと予想されて、 Rails はこのような場合のための特別なヘルパファイルを持っています: <code>app/helpers/application_helper.rb</code>です。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_1">↑</a></li>
<li id="fn-4_2">“foo” と “bar”についてのより詳細な起源について—そして、特に、“foobar” と “FUBAR”が<em>無</em>関係だと思われることについて— <a href="http://www.catb.org/jargon/html/F/foo.html">Jargon File entry on “foo”</a> を見てください。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_2">↑</a></li>
<li id="fn-4_3">Perl や PHP に精通したプログラマはこれを<code>&quot;foo $bar&quot;</code>の例のようなドル記号による自動的な挿入と比較することができるでしょう。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_3">↑</a></li>
<li id="fn-4_4">前もって、この章を通してのやみくもな<em>関数</em> と <em>メソッド</em> の混在を謝罪します; Rubyでは、これらは同じものです: 全てのメソッドは関数で、そして全ての関数はメソッドです。これは全てがオブジェクトだからです。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_4">↑</a></li>
<li id="fn-4_5">さて、そこにはまだ <em>1つ</em> 理解していないことがあります、つまり、Rails がどうやってこれら全てを結びつけているかということです: URIをアクションへのマッピングや、 <code>full_title</code> ヘルパをビューで利用できるようにすることなどについてです。 これはおもしろい題材で、追加的な調査をすることを奨励しますが、<em>どのように</em> Rails が動いているかを正確に知ることは Rails を<em>使う</em> 際には必要ありません。 (深い理解のために、Obie Fernandez による<a href="http://www.amazon.com/gp/product/0321601661"><em>The Rails 3 Way</em></a> をお勧めします。) <a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_5">↑</a></li>
<li id="fn-4_6">ここで使っている<code>second</code> メソッドは今のところ Ruby 自身の一部ではなく、Rails によって追加されています。この場合これが動作したのは、 Rails コンソールは自動的に Rails の Ruby への拡張を含めるからです。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_6">↑</a></li>
<li id="fn-4_7">プログラミングの熟練者は、一方では、ブロックは <em>クロージャ</em>であるということが理解する助けになるかもしれません。これはデータが付属された一度限りの無名関数です。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_7">↑</a></li>
<li id="fn-4_8">Ruby 1.9 は実はハッシュが要素を入力順と同じ順番でいることを保証していますが、特定の順番で数えることは賢いとは言えません。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_8">↑</a></li>
<li id="fn-4_9">少ない手荷物の結果として、シンボルは互いに比較し易いです; 文字列は1文字ずつ比較する必要がありますが、一方でシンボルは一度に全てを比較できます。これはハッシュのキーとして使うために理想的です。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_9">↑</a></li>
<li id="fn-4_10">これらの結果はあなたが使っている Ruby のバージョンによって変わるでしょう。この例ではあなたが Ruby 1.9.3 を使っていることを想定しています。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_10">↑</a></li>
<li id="fn-4_11">Ruby のクラスや <code>self</code> キーワードについての詳細は、<a href="http://railstips.org/">RailsTips</a> の “<a href="http://railstips.org/blog/archives/2006/11/18/class-and-instance-variables-in-ruby/">Ruby におけるクラスとインスタンス変数</a>” を見てください。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_11">↑</a></li>
<li id="fn-4_12">JavaScript に精通している人のために、この機能性はクラスを増やすために組み込みクラスのプロトタイプオブジェクトを使うことに匹敵します。(これを指摘してくださった読者の<a href="http://getsatisfaction.com/railstutorial/topics/adding_methods_to_built_in_classes_comparable_to_using_javascripts_prototype_object">Erik Eldridge</a> に感謝します。) <a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_12">↑</a></li>
<li id="fn-4_13">この階層における各々のクラスが何をするかについて知らなくてもよいです。<em>私は</em> それらが何をしているか全ては知りませんし、そして2005年から Ruby on Rails でプログラミングしてきています。これは (a) 私がひどく無能であるか、(b) あなたは熟練した Rails 開発者に内部について全て知らなくてもなれる、ということのどちらかを意味します。私たち両方のために、後者であることを祈ります。<a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_13">↑</a></li>
<li id="fn-4_14">http://rubykoans.com/ <a class="arrow" href="http://railstutorial.jp/rails-flavored-ruby.html#fnref-4_14">↑</a></li>
</ol>
</div>




</div>
  </body>
</html>
